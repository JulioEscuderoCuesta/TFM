/*
 * generated by Xtext 2.35.0
 */
package es.unican.istr.pasys.tests

import com.google.inject.Inject
import es.unican.istr.pasys.pasys.ComputationalSystem;
import org.eclipse.xtext.testing.InjectWith
import org.eclipse.xtext.testing.extensions.InjectionExtension
import org.eclipse.xtext.testing.util.ParseHelper
import org.junit.jupiter.api.Assertions
import org.junit.jupiter.api.Test
import org.junit.jupiter.api.^extension.ExtendWith
import org.eclipse.xtext.testing.validation.ValidationTestHelper
import es.unican.istr.pasys.pasys.PasysPackage
import es.unican.istr.pasys.validation.MyPasysValidator

@ExtendWith(InjectionExtension)
@InjectWith(MyPasysInjectorProvider)
class MyPasysParsingTest {
	@Inject
	ParseHelper<ComputationalSystem> parseHelper
	
	@Inject
    ValidationTestHelper validationHelper


	// Test completo válido
	
	@Test
	def void testValidModel() {		
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
			    date "20/05/2024"
			    authors "Yo"
				ownedElements {
					PhysicalProcessingNode MainNode 
					      {
					          id "MainNode"
					          ip "127.0..1"
					          speedFactor 1.0
					          userName "gestor"
					          concurrencyLevel 8
					          memorySize 0
					          os "Ubuntu"
					      },
					              
					      ProcessingNodeCluster MainCluster
					      {
					          id "MainCluster"
					          nodes ( MainNode )
					      },
					      
					      ZookeeperService PollutionZkpr
					      {
					          id "PollutionZkpr"
					          serverId 2
					          clientPort "2388"
					          tickTime 2000
					          leaderServers true
					          peerPort "2888"
					          leaderPort "3888"
					          initLimit 5
					          syncLimit 3
					          host MainCluster
					          deploymentConfig NodeDeploymentConf 'kafka-topics.sh' {
					          	isRunning false
					          	   artifactLocator "/home/gestor/apache/services/kafka/bin"
					          	   configFolderPath "/home/gestor/apache/apps/pollution/topics/config"
					          	   dataFolderPath "/home/gestor/apache/apps/pollution/topics/data"
					          	   logFolderPath "/home/gestor/apache/apps/pollution/topics/logs" 
					          	   scriptFolderPath "/home/gestor/apache/apps/pollution/topics/scripts"
					          }
					      },
					      
					      StormService PollutionStorm {
					          id "PollutionStorm"
					          host MainCluster
					          zookeeperConnect PollutionZkpr
					          deploymentConfig NodeDeploymentConf "Conf_storm" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/storm/bin"
							         configFolderPath "/home/gestor/apache/services/storm/config"
							         dataFolderPath "/home/gestor/apache/services/storm/data"
							         logFolderPath "/home/gestor/apache/services/storm/logs"
							         scriptFolderPath "/home/gestor/apache/services/storm/scripts"
							        }
							        nimbus StormNimbus PollutionStormNimbus {
							            id PollutionStormNimbus
							            deploymentConfig NodeDeploymentConf "Conf_storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
								         configFolderPath "/home/gestor/apache/services/storm/config"
								         dataFolderPath "/home/gestor/apache/services/storm/data"
								         logFolderPath "/home/gestor/apache/services/storm/logs"
								         scriptFolderPath "/home/gestor/apache/services/storm/scripts"
								           }
								           host MainCluster
								       }
								       supervisor StormSupervisor PollutionStormSupervisor {
								           id PollutionStormSupervisor
								           deploymentConfig NodeDeploymentConf "Conf_storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
								         configFolderPath "/home/gestor/apache/services/storm/config"
								         dataFolderPath "/home/gestor/apache/services/storm/data"
								         logFolderPath "/home/gestor/apache/services/storm/logs"
								         scriptFolderPath "/home/gestor/apache/services/storm/scripts"
								           }
								           host MainCluster
								           supervisorSlotPorts {
								               "6700", "6701", "6702", "6703"
								           }
								       }
								       ui StormUI PollutionStormUI {
								       	id PollutionStormUI
								       	uiPort "8080"
								       	deploymentConfig NodeDeploymentConf "Conf_storm" {
								       		isRunning false
								       		      artifactLocator "/home/gestor/apache/services/storm/bin"
								       		      configFolderPath "/home/gestor/apache/services/storm/config"
								       		      dataFolderPath "/home/gestor/apache/services/storm/data"
								       		      logFolderPath "/home/gestor/apache/services/storm/logs"
								       		      scriptFolderPath "/home/gestor/apache/services/storm/scripts"
								       		  }
								       		  host MainCluster  
								       }    
								   },
								  
								   
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MainCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							            configFolderPath "/home/gestor/apache/services/kafka/config"
							            dataFolderPath "/home/gestor/apache/services/kafka/data"
							            logFolderPath "/home/gestor/apache/services/kafka/logs"
							            scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://127.0.0.1:9092"
						listeners "PLAINTEXT://127.0.0.1:9092"	
					},
					
					KafkaWorkloadStreamData "Pollution" {
						id "PollutionKafka"
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "kafka-topics.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							            configFolderPath "/home/gestor/apache/services/topics/config"
							            dataFolderPath "/home/gestor/apache/services/topics/data"
							            logFolderPath "/home/gestor/apache/services/topics/logs"	
							            scriptFolderPath "/home/gestor/apache/services/topics/scripts"
						}
					},
						
					
					CassandraService "Pollution Cassandra" {
						id PollutionCassandra
						     	logging root
						     	passwd root
						     	port 9042
						     	autoBootstrap false
						     	numTokens 255
						     	dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						     	storagePort "7000"
						     	sslStoragePort "7001"
						     	rpcPort "9160"
						     	host MainCluster
						     	deploymentConfig NodeDeploymentConf "Conf_Cassandra" {
						     		isRunning false
						     		      artifactLocator "/home/gestor/apache/services/cassandra/bin"
						     		      configFolderPath "/home/gestor/apache/services/cassandra/config"
						     		      dataFolderPath "/home/gestor/apache/services/cassandra/data"
						     		      logFolderPath "/home/gestor/apache/services/cassandra/logs"
						     		      scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						     	}
						     	dataCenters {
						     		DataCenter PollutionCluster {
						     			id PollutionCluster
						     			racks {
						     				Rack PollutionCluster {
						     					id PollutionClusterRack
						     					nodes MainCluster 
						     				}
						     			}
						     		}
						     	}
						     	cqlSchemas {
						     		DeploymentFileDescriptor {
						     			fileContent "/home/gestor/apache/apps/pollution/workflows/data"        			   			
						     			fileName "cassandra_schema.sql"
						     			filePath "/home/gestor/apache/apps/pollution/workflows/data"
						     			elementType CASSANDRA_SCHEMA             			
						     			owner MainNode
						     		}
						     	}
						     	endpointSnitch GossipingPropertyFileSnitch
						     	seeds MainCluster
						     	seedProviderClass SimpleSeedProvider
			
					},
					
					Workflow PollutionProcess {
						id PollutionProcess
						     	ownedTasks {
						     		Task MainTask {
						     			id MainTask
						     			triggerStreamData Pollution 
						     			implementingClassName "es.unican.dintenr.santanderPollution.SantanderPollutionTopology"	 
						     		}		
						     	}
						     	rootTask MainTask
						scheduler PollutionStorm
						deploymentConfig NodeDeploymentConf "SantanderPollution.jar" {
							isRunning false
							            artifactLocator "/home/gestor/apache/apps/pollution/workflows/jars"
							            configFolderPath "/home/gestor/apache/apps/pollution/workflows/config"
							            dataFolderPath "/home/gestor/apache/apps/pollution/workflows/data"
							            logFolderPath "/home/gestor/apache/apps/pollution/workflows/logs"
							            scriptFolderPath "/home/gestor/apache/apps/pollution/workflows/scripts"
							    	}
			
					}
				}
			}
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
		
	// Artifact Descriptor
		
	@Test
	def void testArtifactDescriptorCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath "/path/to/file"
								localPath "/path"
							}
						)
					}
				 }
			}
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testArtifactDescriptorFileNameEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName ""
								filePath "/path/to/file"
								localPath "/path"
							}
						)
					}
				 }
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.ARTIFACT_DESCRIPTOR,
	    	MyPasysValidator.EMPTY_FIELD)
	}

	@Test
	def void testArtifactDescriptorFilePathEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath ""
								localPath "/path"
							}
						)
					}
				 }
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.ARTIFACT_DESCRIPTOR,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testArtifactDescriptorFilePathNotCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath "=)PATH"
								localPath "825566"
							}
						)
					}	
				 }
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.ARTIFACT_DESCRIPTOR,
	    	MyPasysValidator.INVALID_PATH)
	}
	
	@Test
	def void testArtifactDescriptorLocalPathEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath "/path"
								localPath ""
							}
						)
					}
				 }
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.ARTIFACT_DESCRIPTOR,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testArtifactDescriptorLocalPathNotCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath "/path"
								localPath "path/valid?"
							}
						)
					}
				 }
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.ARTIFACT_DESCRIPTOR,
	    	MyPasysValidator.INVALID_PATH)
	}
	
	// AWS Virtual Processing Node
	
	@Test
	def void testAWSVirtualProcessingNodeKeyPairFormatEqualsCorrect() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.8"
	                	keyPair "key=value, key2=value2"
	                }
	            }
	        }
	    ''')
	    
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testAWSVirtualProcessingNodeKayPairFormatColonCorrect() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.8"
	                	keyPair "{key:value, key2:value2}"
	                }
	            }
	        }
	    ''')
	    
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testAWSVirtualProcessingNodeConcurrencyLevelLessThanZero() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP ""
	                	keyPair "key=value, key2=value2"
	                	concurrencyLevel -1
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}	
	
	@Test
	def void testAWSVirtualProcessingNodeAMIEmpty() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP ""
	                	keyPair "key=value, key2=value2"
	                	AMI ""
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
		
	@Test
	def void testAWSVirtualProcessingNodeExternalIPEmpty() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP ""
	                	keyPair "key=value, key2=value2"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
			
	@Test
	def void testAWSVirtualProcessingNodeExternalIPLessThanFourOctets() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0"
	                	keyPair "key=value, key2=value2"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.INVALID_IP)
	}
	
			
	@Test
	def void testAWSVirtualProcessingNodeExternalIPMoreThanFourOctets() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.1.3"
	                	keyPair "key=value, key2=value2"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.INVALID_IP)
	}
	
			
	@Test
	def void testAWSVirtualProcessingNodeExternalIPGreaterThan255() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.256"
	                	keyPair "key=value, key2=value2"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.INVALID_IP)
	}

	@Test
	def void testAWSVirtualProcessingNodeInstanceTypeEmpty() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP ""
	                	keyPair "key=value, key2=value2"
	                	instanceType ""
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testAWSVirtualProcessingNodeIPEmpty() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip ""
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.1"
	                	keyPair "key=value, key2=value2"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
			
	@Test
	def void testAWSVirtualProcessingNodeIPLessThanFourOctets() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255."
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.1"
	                	keyPair "key=value, key2=value2"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.INVALID_IP)
	}
	
			
	@Test
	def void testAWSVirtualProcessingNodeIPMoreThanFourOctets() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1.3"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.1"
	                	keyPair "key=value, key2=value2"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.INVALID_IP)
	}
	
			
	@Test
	def void testAWSVirtualProcessingNodeIPGreaterThan255() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.256"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.1"
	                	keyPair "key=value, key2=value2"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.INVALID_IP)
	}
	
	@Test
	def void testAWSVirtualProcessingNodeKayPairEmpty() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.8"
	                	keyPair ""
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testAWSVirtualProcessingNodeKayPairNoComa() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.8"
	                	keyPair "key=value key2=value"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.INVALID_KEY_VALUE_FORMAT)
	}
		
	@Test
	def void testAWSVirtualProcessingNodeKayPairNoOpenCurlyBrace() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.8"
	                	keyPair "key:value, key2:value}"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.INVALID_KEY_VALUE_FORMAT)
	}
	
	@Test
	def void testAWSVirtualProcessingNodeKayPairNoClosedCurlyBrace() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.8"
	                	keyPair "{key:value, key2:value"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.INVALID_KEY_VALUE_FORMAT)
	}
	
	@Test
	def void testAWSVirtualProcessingNodeKayPairMixinPatterns() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "100.24.24.2"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP "200.0.0.8"
	                	keyPair "{key=value, key2:value}"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.INVALID_KEY_VALUE_FORMAT)
	}
	
	@Test
	def void testAWSVirtualProcessingNodeMemorySizeLessThanZero() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP ""
	                	keyPair "key=value, key2=value2"
	                	memorySize -1
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
				
	@Test
	def void testAWSVirtualProcessingNodeOsEmpty() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP ""
	                	keyPair "key=value, key2=value2"
	                	os ""
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testAWSVirtualProcessingNodeSecurityGroupEmpty() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP ""
	                	keyPair "key=value, key2=value2"
	                	securityGroup ""
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
		
	@Test
	def void testAWSVirtualProcessingNodeSpeedFactorLessThanZero() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor -0.01
	                	userName "Julio"
	                	externalIP ""
	                	keyPair "key=value, key2=value2"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}	
	
	@Test
	def void testAWSVirtualProcessingNodeSubnetEmpty() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP ""
	                	keyPair "key=value, key2=value2"
	                	subnet ""
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testAWSVirtualProcessingNodeUserNameEmpty() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName ""
	                	externalIP ""
	                	keyPair "key=value, key2=value2"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
		
	@Test
	def void testAWSVirtualProcessingNodeVpcEmpty() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                AWSVirtualProcessingNode InvalidNode {
	               		id "id"
	                    ip "255.255.255.1"
	                	speedFactor 0.2
	                	userName "Julio"
	                	externalIP ""
	                	keyPair "key=value, key2=value2"
	                	vpc ""
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.AWS_VIRTUAL_PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	// Cassandra Service
	
	@Test
	def void testCassandraServiceDataCorrect() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/dir"
						storagePort "7001"
						sslStoragePort "14000"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters {
			        		DataCenter PollutionCluster {
			        			id PollutionCluster
			        			racks {
			        				Rack PollutionCluster {
			        					id PollutionClusterRack
			        					nodes CassandraCluster 
			        				}
			        			}
			        		}
			        	}
					}
				}
			}
		''')
	
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testCassandraServiceDataFileDirClassEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir ""
						storagePort "7001"
						sslStoragePort "14000"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters {
			        		DataCenter PollutionCluster {
			        			id PollutionCluster
			        			racks {
			        				Rack PollutionCluster {
			        					id PollutionClusterRack
			        					nodes CassandraCluster 
			        				}
			        			}
			        		}
			        	}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testCassandraServiceDataFileDirNotAPath() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 25
						dataFileDir "pa//?%$€tlsl7"
						storagePort "7001"
						sslStoragePort "14000"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters {
			        		DataCenter PollutionCluster {
			        			id PollutionCluster
			        			racks {
			        				Rack PollutionCluster {
			        					id PollutionClusterRack
			        					nodes CassandraCluster 
			        				}
			        			}
			        		}
			        	}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PATH)
	}
		
	@Test
	def void testCassandraServiceEndPointSnitchClassEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7001"
						sslStoragePort "14000"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters {
			        		DataCenter PollutionCluster {
			        			id PollutionCluster
			        			racks {
			        				Rack PollutionCluster {
			        					id PollutionClusterRack
			        					nodes CassandraCluster 
			        				}
			        			}
			        		}
			        	}
			        	cqlSchemas {
			        		DeploymentFileDescriptor {
			        			fileContent "/home/gestor/apache/apps/pollution/workflows/data"        			   			
			        			fileName "cassandra_schema.sql"
			        			filePath "/home/gestor/apache/apps/pollution/workflows/data"
			        			elementType CASSANDRA_SCHEMA             			
			        			owner MyNode
			        		}
			        	}
			        	endpointSnitch ""
			        	seeds CassandraCluster
			        	seedProviderClass SimpleSeedProvider
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testCassandraServiceNumTokensLessThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens -1
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort "7001"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testCassandraServiceLoggingEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging ""
						passwd root
						port 9042
						autoBootstrap false
						numTokens 2
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort "7001"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testCassandraServicePasswordEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd ""
						port 9042
						autoBootstrap false
						numTokens 2
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort "7001"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testCassandraServicePortSmallerThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 1023
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort "7001"
						rpcPort "9024"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testCassandraServicePortGreaterThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 65536
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort "7001"
						rpcPort "9024"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testCassandraServiceRcpPortEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort "7001"
						rpcPort ""
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testCassandraServiceRcpPortSmallerThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort "7001"
						rpcPort "1023"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testCassandraServiceRcpPortGreaterThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort "7001"
						rpcPort "65536"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testCassandraServiceRcpPortNotANumber() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort "7001"
						rpcPort "NotANumber"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testCassandraServiceSslStoragePortEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort ""
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testCassandraServiceSslStoragePortSmallerThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort "1023"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testCassandraServiceSslStoragePortGreaterThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort "65553"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testCassandraServiceSslStoragePortNotANumber() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7000"
						sslStoragePort "NotANumber"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testCassandraServiceStoragePortEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort ""
						sslStoragePort "7001"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testCassandraServiceStoragePortSmallerThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "1023"
						sslStoragePort "7001"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testCassandraServiceStoragePortGreaterThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "65536"
						sslStoragePort "7001"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testCassandraServiceStoragePortNotANumber() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "NotANumber"
						sslStoragePort "7001"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testCassandraServiceRcpPortAndSslStoragePortSameValue() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7001"
						sslStoragePort "9160"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.SAME_PORTS)
	}
	
	@Test
	def void testCassandraServiceRcpPortAndStoragePortSameValue() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "9160"
						sslStoragePort "7001"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.SAME_PORTS)
	}
	
	@Test
	def void testCassandraServiceSslStoragePortAndStoragePortSameValue() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "9160"
						sslStoragePort "9160"
						rpcPort "7001"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters { 
							DataCenter PollutionCluster {
								id PollutionCluster
								racks { 
									Rack PollutionCluster {
										id PollutionCluster
										nodes CassandraCluster
										}
									}
								}
							}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.SAME_PORTS)
	}
	
	@Test
	def void testCassandraServiceSeedProviderClassEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode CassandraNode {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster CassandraCluster {
						id CasandraCluster
						nodes ( CassandraNode )
					},
					
					CassandraService PollutionCassandra {
						id PollutionCassandra
						logging root
						passwd root
						port 9042
						autoBootstrap false
						numTokens 255
						dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
						storagePort "7001"
						sslStoragePort "14000"
						rpcPort "9160"
						host CassandraCluster
						deploymentConfig NodeDeploymentConf "Conf cassandra" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/cassandra/bin"
				            configFolderPath "/home/gestor/apache/services/cassandra/config"
				            dataFolderPath "/home/gestor/apache/services/cassandra/data"
				            logFolderPath "/home/gestor/apache/services/cassandra/logs"
				            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
						}
						dataCenters {
			        		DataCenter PollutionCluster {
			        			id PollutionCluster
			        			racks {
			        				Rack PollutionCluster {
			        					id PollutionClusterRack
			        					nodes CassandraCluster 
			        				}
			        			}
			        		}
			        	}
			        	cqlSchemas {
			        		DeploymentFileDescriptor {
			        			fileContent "/home/gestor/apache/apps/pollution/workflows/data"        			   			
			        			fileName "cassandra_schema.sql"
			        			filePath "/home/gestor/apache/apps/pollution/workflows/data"
			        			elementType CASSANDRA_SCHEMA             			
			        			owner MyNode
			        		}
			        	}
			        	endpointSnitch endpointString
			        	seeds CassandraCluster
			        	seedProviderClass ""
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.CASSANDRA_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	// Communication Meter
	
	@Test
	def void testCommunicationMeterMonitoringPortEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath "/path"
								localPath "/path"
							}
						)
						concurrencyLevel 2
						configData "configData"
						configFiles (
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
						connectedTo ( network )
						launchingScripts ( 
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType KAFKA_FLOW_STREAM
								owner MyNode
							}
						)
						memorySize 255
						os "W"
						ownedMeters { 
							CommunicationMeter meter1 {
								id ddd
								metric networkUt
								monitoringPort ""
								monitoringTime 4333
								deploymentConfig NodeDeploymentConf "conf" {
										isRunning false
										artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
						                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
						                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
						                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
						                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
									}
								monitoringServer prometheus
							},
						}	
					},
					
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					Network network {
						id network
						bandwith 3.0
					},
					
					NetworkUtilization networkUt {
						id net
						target network
					},
					
					ProcessingNodeMemory nodememory {
						id nodememory
						target MyNode
					},
					
					ProcessingNodeUtilization nodeutilization {
						id utilization
						target MyNode 
					},
					
					PrometheusService prometheus {
						id prometheus
						host cluster
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas 1
							args "ddd"
							command "dddd"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "Properties"
							externalIP "200.0.0.1"
							imagePullPolicy "ed"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							serviceType CLUSTER_IP
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}			
						}	
						exportersData { 
							ExporterData data {
								artifact "dd"
							}
						}
						monitorizedMeters ( "MyNode.meter1" )
					}
				 }
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.COMMUNICATION_METER,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testCommunicationMeterMonitoringPortSmallerThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath "/path"
								localPath "/path"
							}
						)
						concurrencyLevel 2
						configData "configData"
						configFiles (
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
						connectedTo ( network )
						launchingScripts ( 
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType KAFKA_FLOW_STREAM
								owner MyNode
							}
						)
						memorySize 255
						os "W"
						ownedMeters { 
							CommunicationMeter meter1 {
								id ddd
								metric networkUt
								monitoringPort "1023"
								monitoringTime 4333
								deploymentConfig NodeDeploymentConf "conf" {
										isRunning false
										artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
						                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
						                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
						                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
						                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
									}
								monitoringServer prometheus
							},
						}	
					},
					
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					Network network {
						id network
						bandwith 3.0
					},
					
					NetworkUtilization networkUt {
						id net
						target network
					},
					
					ProcessingNodeMemory nodememory {
						id nodememory
						target MyNode
					},
					
					ProcessingNodeUtilization nodeutilization {
						id utilization
						target MyNode 
					},
					
					PrometheusService prometheus {
						id prometheus
						host cluster
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas 1
							args "ddd"
							command "dddd"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "Properties"
							externalIP "200.0.0.1"
							imagePullPolicy "ed"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							serviceType CLUSTER_IP
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}			
						}	
						exportersData { 
							ExporterData data {
								artifact "dd"
							}
						}
						monitorizedMeters ( "MyNode.meter1" )
					}
				 }
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.COMMUNICATION_METER,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}	
	
	@Test
	def void testCommunicationMeterMonitoringPortGreaterThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath "/path"
								localPath "/path"
							}
						)
						concurrencyLevel 2
						configData "configData"
						configFiles (
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
						connectedTo ( network )
						launchingScripts ( 
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType KAFKA_FLOW_STREAM
								owner MyNode
							}
						)
						memorySize 255
						os "W"
						ownedMeters { 
							CommunicationMeter meter1 {
								id ddd
								metric networkUt
								monitoringPort "65536"
								monitoringTime 4333
								deploymentConfig NodeDeploymentConf "conf" {
										isRunning false
										artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
						                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
						                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
						                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
						                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
									}
								monitoringServer prometheus
							},
							NodeResourceMeter resourceMeter {
								id resourceMeter
								monitoringPort "3333"
								monitoringTime 323232
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								mMetric nodememory
								monitoringServer prometheus
								uMetric nodeutilization
							}
						}	
					},
					
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					Network network {
						id network
						bandwith 3.0
					},
					
					NetworkUtilization networkUt {
						id net
						target network
					},
					
					ProcessingNodeMemory nodememory {
						id nodememory
						target MyNode
					},
					
					ProcessingNodeUtilization nodeutilization {
						id utilization
						target MyNode 
					},
					
					PrometheusService prometheus {
						id prometheus
						host cluster
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas 1
							args "ddd"
							command "dddd"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "Properties"
							externalIP "200.0.0.1"
							imagePullPolicy "ed"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							serviceType CLUSTER_IP
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}			
						}	
						exportersData { 
							ExporterData data {
								artifact "dd"
							}
						}
						monitorizedMeters ( "MyNode.meter1" )
					}
				 }
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.COMMUNICATION_METER,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}	
	
	@Test
	def void testCommunicationMeterMonitoringPortIsNotANumber() {
	    val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath "/path"
								localPath "/path"
							}
						)
						concurrencyLevel 2
						configData "configData"
						configFiles (
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
						connectedTo ( network )
						launchingScripts ( 
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType KAFKA_FLOW_STREAM
								owner MyNode
							}
						)
						memorySize 255
						os "W"
						ownedMeters { 
							CommunicationMeter meter1 {
								id ddd
								metric networkUt
								monitoringPort "NotANumber"
								monitoringTime 4333
								deploymentConfig NodeDeploymentConf "conf" {
										isRunning false
										artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
						                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
						                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
						                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
						                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
									}
								monitoringServer prometheus
							},
						}	
					},
					
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					Network network {
						id network
						bandwith 3.0
					},
					
					NetworkUtilization networkUt {
						id net
						target network
					},
					
					ProcessingNodeMemory nodememory {
						id nodememory
						target MyNode
					},
					
					ProcessingNodeUtilization nodeutilization {
						id utilization
						target MyNode 
					},
					
					PrometheusService prometheus {
						id prometheus
						host cluster
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas 1
							args "ddd"
							command "dddd"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "Properties"
							externalIP "200.0.0.1"
							imagePullPolicy "ed"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							serviceType CLUSTER_IP
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}			
						}	
						exportersData { 
							ExporterData data {
								artifact "dd"
							}
						}
						monitorizedMeters ( "MyNode.meter1" )
					}
				 }
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.COMMUNICATION_METER,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testCommunicationMeterMonitoringTimeLessThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath "/path"
								localPath "/path"
							}
						)
						concurrencyLevel 2
						configData "configData"
						configFiles (
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
						connectedTo ( network )
						launchingScripts ( 
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType KAFKA_FLOW_STREAM
								owner MyNode
							}
						)
						memorySize 255
						os "W"
						ownedMeters { 
							CommunicationMeter meter1 {
								id ddd
								metric networkUt
								monitoringPort "54444"
								monitoringTime -1
								deploymentConfig NodeDeploymentConf "conf" {
										isRunning false
										artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
						                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
						                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
						                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
						                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
									}
								monitoringServer prometheus
							}
						}	
					},
					
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					Network network {
						id network
						bandwith 3.0
					},
					
					NetworkUtilization networkUt {
						id net
						target network
					},
					
					ProcessingNodeMemory nodememory {
						id nodememory
						target MyNode
					},
					
					ProcessingNodeUtilization nodeutilization {
						id utilization
						target MyNode 
					},
					
					PrometheusService prometheus {
						id prometheus
						host cluster
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas 1
							args "ddd"
							command "dddd"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "Properties"
							externalIP "200.0.0.1"
							imagePullPolicy "ed"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							serviceType CLUSTER_IP
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}			
						}	
						exportersData { 
							ExporterData data {
								artifact "dd"
							}
						}
						monitorizedMeters ( "MyNode.meter1" )
					}
				 }
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.COMMUNICATION_METER,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	
	// Deployment Constraints
	
	@Test
	def void testDeploymentConstraintsCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host cluster
						deploymentConfig KubernetesDeploymentConf "New Kubernetes Deployment Conf" {
							replicas 1
							constraints DeploymentConstraints {
								labels "key=value"
								resources "key2=value2"
							}
						}
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "/home/gestor/apache/Services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					}
				}
			}
		''')
	
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testDeploymentConstraintsLabelsEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
							
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host cluster
						deploymentConfig KubernetesDeploymentConf "New Kubernetes Deployment Conf" {
							replicas 1
							constraints DeploymentConstraints {
								labels ""
								resources "key2=value2"
							}
						}
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "/home/gestor/apache/Services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.DEPLOYMENT_CONSTRAINTS,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testDeploymentConstraintsLabelsInvalidFormat() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host cluster
						deploymentConfig KubernetesDeploymentConf "New Kubernetes Deployment Conf" {
							replicas 1
							constraints DeploymentConstraints {
								labels "key==value"
								resources "key2=value, key3=value"
							}
						}
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "/home/gestor/apache/Services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.DEPLOYMENT_CONSTRAINTS,
	    	MyPasysValidator.INVALID_PROPERTIES_PATTERN)
	}
	
	@Test
	def void testDeploymentConstraintsResourcesEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host cluster
						deploymentConfig KubernetesDeploymentConf "New Kubernetes Deployment Conf" {
							replicas 1
							constraints DeploymentConstraints {
								labels "key=value"
								resources ""
							}
						}
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "/home/gestor/apache/Services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.DEPLOYMENT_CONSTRAINTS,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testDeploymentConstraintsResourcesInvalidFormat() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host cluster
						deploymentConfig KubernetesDeploymentConf "New Kubernetes Deployment Conf" {
							replicas 1
							constraints DeploymentConstraints {
								labels "key=value"
								resources "key2!=value"
							}
						}
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "/home/gestor/apache/Services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.DEPLOYMENT_CONSTRAINTS,
	    	MyPasysValidator.INVALID_PROPERTIES_PATTERN)
	}
	
	
	// Deployment File Descriptor
	
	@Test
	def void testDeploymentFileDescriptorCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						configFiles (
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
					}
				 }
			}
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
		
	@Test
	def void testDeploymentFileDescriptorFileContentEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						configFiles (
							DeploymentFileDescriptor {
								fileContent ""
								fileName "file"
								filePath "/path"
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
					}	
				 }
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.DEPLOYMENT_FILE_DESCRIPTOR,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testDeploymentFileDescriptorFileNameEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						configFiles (
							DeploymentFileDescriptor {
								fileContent "content"
								fileName ""
								filePath "/path"
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
					}
				 }
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.DEPLOYMENT_FILE_DESCRIPTOR,
	    	MyPasysValidator.EMPTY_FIELD)
	}

	@Test
	def void testDeploymentFileDescriptorFilePathEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						configFiles (
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath ""
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
					}
				 }
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.DEPLOYMENT_FILE_DESCRIPTOR,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testDeploymentFileDescriptorFilePathNotCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						configFiles (
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path[]"
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
					}	
				 }
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.DEPLOYMENT_FILE_DESCRIPTOR,
	    	MyPasysValidator.INVALID_PATH)
	}


	// Derived Stream Data
	
	@Test
	def void testDerivedFlowStreamDataCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
						DerivedStreamData streamData {
								id streamData
								numPartitions 22
								numReplication 2
								retention_ms 222
								retention_bytes 22
								cleanupPolicy false
								inputs ( Pollution )
								isSingleUse false
								messageSize 222
								pattern "pattern"
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "myKey"
									}					
								}
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort "3333"
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "schema"
							}
						}
					}
				}	
			}
		''')

		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testDerivedFlowStreamDataMessageSizeLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							DerivedStreamData streamData {
								id streamData
								numPartitions 22
								numReplication 2
								retention_ms 222
								retention_bytes 22
								cleanupPolicy false
								inputs ( Pollution )
								isSingleUse false
								messageSize -1
								pattern "pattern"
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "myKey"
									}					
								}
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort "3333"
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "schema"
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.DERIVED_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testDerivedFlowStreamDataNumPartitionsLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							DerivedStreamData streamData {
								id streamData
								numPartitions -1
								numReplication 2
								retention_ms 222
								retention_bytes 22
								cleanupPolicy false
								inputs ( Pollution )
								isSingleUse false
								messageSize 222
								pattern "pattern"
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "myKey"
									}					
								}
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort "3333"
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "schema"
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.DERIVED_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testDerivedFlowStreamDataNumReplicationLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							DerivedStreamData streamData {
								id streamData
								numPartitions 22
								numReplication -1
								retention_ms 222
								retention_bytes 22
								cleanupPolicy false
								inputs ( Pollution )
								isSingleUse false
								messageSize 222
								pattern "pattern"
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "myKey"
									}					
								}
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort "3333"
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "schema"
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.DERIVED_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testDerivedFlowStreamDataRetentionBytesLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							DerivedStreamData streamData {
								id streamData
								numPartitions 22
								numReplication 2
								retention_ms 222
								retention_bytes -1
								cleanupPolicy false
								inputs ( Pollution )
								isSingleUse false
								messageSize 222
								pattern "pattern"
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "myKey"
									}					
								}
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort "3333"
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "schema"
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.DERIVED_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testDerivedFlowStreamDataRetentionsMSLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							DerivedStreamData streamData {
								id streamData
								numPartitions 22
								numReplication 2
								retention_ms -1
								retention_bytes 22
								cleanupPolicy false
								inputs ( Pollution )
								isSingleUse false
								messageSize 222
								pattern "pattern"
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "myKey"
									}					
								}
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort "3333"
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "schema"
							}
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.DERIVED_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testDerivedStreamDataPatternEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							DerivedStreamData streamData {
								id streamData
								numPartitions 22
								numReplication 2
								retention_ms 222
								retention_bytes 22
								cleanupPolicy false
								inputs ( Pollution )
								isSingleUse false
								messageSize 222
								pattern ""
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "myKey"
									}					
								}
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort "3333"
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "SCHEMA"
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.DERIVED_STREAM_DATA,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testDerivedStreamDataSchemaFileEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							DerivedStreamData streamData {
								id streamData
								numPartitions 22
								numReplication 2
								retention_ms 222
								retention_bytes 22
								cleanupPolicy false
								inputs ( Pollution )
								isSingleUse false
								messageSize 222
								pattern "pattern"
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "myKey"
									}					
								}
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort "3333"
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile ""
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.DERIVED_STREAM_DATA,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	// Exporter Data
	
	@Test
	def void testExporterDataCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}	
						exportersData { 
							ExporterData data {
								artifact "artifact"
							}
						}
					}
				}
			}	
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testExporterDataArtifactEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PrometheusService prometheus {
						id prometheus
						host cluster
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}	
						exportersData { 
							ExporterData data {
								artifact ""
							}
						}
					}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.EXPORTER_DATA,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	
	// Host and DeploymentConfiguration
	
	@Test
	def void testHostIsOfProcessingNodeClusterDeploymentConfShouldBeOfNodeDeploymentConf() {
	    val model = parseHelper.parse('''
	        ComputationalSystem SantanderPollution {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	        	ownedElements {
	        		PhysicalProcessingNode NimbusNode {
	        			id NimbusNode
	        			ip "172.31.16.48"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 8 
	        			os Ubuntu
	        		},
	        		
	        		PhysicalProcessingNode SupervisorNode {
	        			id SupervisorNode
	        			ip "172.31.16.51"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 8 
	        			os Ubuntu
	        		},
	        		
	        		PhysicalProcessingNode CassandraNode {
	        			id CassandraNode
	        			ip "172.31.16.47"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 8 
	        			os Ubuntu
	        		},
	        		
	        		PhysicalProcessingNode KafkaNode {
	        			id KafkaNode
	        			ip "172.31.16.52"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 8 
	        			os Ubuntu
	        		},
	        		
	        		PhysicalProcessingNode ZkNode {
	        			id ZkNode
	        			ip "172.31.16.49"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 8 
	        			os Ubuntu
	        		},
	        		
	        		ProcessingNodeCluster StormCluster {
	        			id StormCluster
	        			nodes ( NimbusNode, SupervisorNode )
	        		},
	        		
	        		ProcessingNodeCluster NimbusCluster {
	        			id NimbusCluster
	        			nodes ( NimbusNode )
	        		}, 
	        		
	        		ProcessingNodeCluster SupervisorCluster {
	        			id SupervisorCluster
	        			nodes ( SupervisorNode )
	        		}, 
	        				
	        		ProcessingNodeCluster CassandraCluster {
	        			id CasandraCluster
	        			nodes ( CassandraNode )
	        		},
	        		
	        		ProcessingNodeCluster KafkaCluster {
	        			id KafkaCluster
	        			nodes ( KafkaNode )
	        		},
	        		
	        		ProcessingNodeCluster ZkCluster {
	        			id ZkCluster
	        			nodes ( ZkNode )
	        		}, 
	        		
	        		ZookeeperService PollutionZkpr {
	        			id PollutionZkpr
	        			serverId 0
	        			clientPort "2181"
	        			tickTime 2000
	        			leaderServers true
	        			peerPort "2888"
	        			leaderPort "3888"
	        			initLimit 5
	        			syncLimit 3
	        			host ZkCluster
	        			deploymentConfig KubernetesDeploymentConf "gcr.io/google_containers/kubernetes-kafka" {
	        				replicas 3
	        				imagePullPolicy IfNotPresent
	        				imageTag "1.0-10.2.1"
	        				serviceType LOAD_BALANCER
	        			}		
	        		},
	        	
	        	 	KafkaService PollutionKafka {
	        			commId 1
	        			id PollutionKafka
	        			clientPort "9092"
	        			autoCreateTopicEnable false
	        			deleteTopicEnable false
	        			zookeeperConnect PollutionZkpr
	        			zookeeperConnectionTimeout 6000
	        			numPartitions 4
	        			numRecoveryThreadsPerDataDir 1
	        			logFlushInterval 1000
	        			logFlushIntervalMessages 10000
	        			numIOThreads 8
	        			numNetworkThreads 3
	        			socketReceiveBufferBytes 12400
	        			socketRequestMaxBytes 104857600
	        			socketSendBufferBytes 102400
	        			host KafkaCluster
	        			deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/services/kafka/bin"
	                        configFolderPath "/home/gestor/apache/services/kafka/config"
	                        dataFolderPath "/home/gestor/apache/services/kafka/data"
	                        logFolderPath "/home/gestor/apache/services/kafka/logs"
	                        scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
	        			}
	        			advertisedListeners "PLAINTEXT://172.31.16.47:9092"
	        			listeners "PLAINTEXT://172.31.16.47:9092"	
	        		},
	        		
	        		StormService PollutionStorm {
	        			id PollutionStorm
	        			host NimbusCluster
	        			zookeeperConnect PollutionZkpr
	        			deploymentConfig NodeDeploymentConf "storm" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/services/storm/bin"
	        	            configFolderPath "/home/gestor/apache/services/storm/config"
	        	            dataFolderPath "/home/gestor/apache/services/storm/data"
	        	            logFolderPath "/home/gestor/apache/services/storm/logs"
	        	            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
	        			}
	        			nimbus StormNimbus PollutionStormNimbus {
	        				id PollutionStormNimbus
	        				deploymentConfig NodeDeploymentConf "storm" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/storm/bin"
	        		            configFolderPath "/home/gestor/apache/services/storm/config"
	        		            dataFolderPath "/home/gestor/apache/services/storm/data"
	        		            logFolderPath "/home/gestor/apache/services/storm/logs"
	        		            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
	        				}
	        				host NimbusCluster
	        			}
	        			supervisor StormSupervisor PollutioStormSupervisor {
	        				id PollutionStormSupervisor
	        				deploymentConfig NodeDeploymentConf "storm" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/storm/bin"
	        		            configFolderPath "/home/gestor/apache/services/storm/config"
	        		            dataFolderPath "/home/gestor/apache/services/storm/data"
	        		            logFolderPath "/home/gestor/apache/services/storm/logs"		
	        		            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
	        				}
	        				host SupervisorCluster 
	        				supervisorSlotPorts { "6700", "6701", "6702", "6703" }
	        			}
	        			ui StormUI PollutionStormUI {
	        				id PollutionStormUI
	        				uiPort "8080"
	        				deploymentConfig NodeDeploymentConf "storm" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/storm/bin"
	        		            configFolderPath "/home/gestor/apache/services/storm/config"
	        		            dataFolderPath "/home/gestor/apache/services/storm/data"
	        		            logFolderPath "/home/gestor/apache/services/storm/logs"	
	        		            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
	        				}
	        				host NimbusCluster
	        			}
	        
	        		},
	        		
	        		KafkaWorkloadStreamData Pollution {
	        			id Pollution
	        			cleanupPolicy false
	        			retention_ms 0
	        			retention_bytes 0
	        			numPartitions 1
	        			numReplication 1
	        			messageSize 0
	        			holder PollutionKafka
	        			deploymentConfig NodeDeploymentConf "kafka-topics.sh" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/kafka/bin"
	        		            configFolderPath "/home/gestor/apache/services/kafka/config"
	        		            dataFolderPath "/home/gestor/apache/services/kafka/data"
	        		            logFolderPath "/home/gestor/apache/services/kafka/logs"			
	        					scriptFolderPath "/home/gestor/apache/services/kafka/scripts"	
	        			}
	        		},
	        		
	        		Workflow PollutionProcess {
	        			id PollutionProcess
	        			ownedTasks { 
	        				Task MainTask {	
	        					id MainTask
	        					triggerStreamData Pollution
	        					implementingClassName "es.unican.dintenr.santanderPollution.SantanderPollutionTopology"
	        					}
	        				}
	        			rootTask MainTask				
	        			scheduler PollutionStorm
	        			deploymentConfig NodeDeploymentConf "SantanderPollution.jar" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/pollution/workflows/bin"
	        	            configFolderPath "/home/gestor/apache/pollution/workflows/config"
	        	            dataFolderPath "/home/gestor/apache/pollution/workflows/data"
	        	            logFolderPath "/home/gestor/apache/pollution/workflows/logs"
	        	            scriptFolderPath "/home/gestor/apache/pollution/workflows/scripts"
	        			}
	        
	        		},
	        		
	        		CassandraService PollutionCassandra {
	        			id PollutionCassandra
	        			logging root
	        			passwd root
	        			port 9042
	        			autoBootstrap false
	        			numTokens 255
	        			dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
	        			storagePort "7000"
	        			sslStoragePort "7001"
	        			rpcPort "9160"
	        			host CassandraCluster
	        			deploymentConfig NodeDeploymentConf "Conf cassandra" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/services/cassandra/bin"
	        	            configFolderPath "/home/gestor/apache/services/cassandra/config"
	        	            dataFolderPath "/home/gestor/apache/services/cassandra/data"
	        	            logFolderPath "/home/gestor/apache/services/cassandra/logs"
	        	            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
	        			}
	        			dataCenters { 
	        				DataCenter PollutionCluster {
	        					id PollutionCluster
	        					racks { 
	        						Rack PollutionCluster {
	        							id PollutionCluster
	        							nodes CassandraCluster
	        							}
	        						}
	        					}
	        				}
	        		}
	        		
	        		
	        	}
	        }
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_DEPLOYMENT_CONF)
	}
	
	@Test
	def void testHostIsOfKubernetesClusterDeploymentConfShouldBeOfKubernetesDeploymentConf() {
	    val model = parseHelper.parse('''
	        ComputationalSystem SantanderPollution {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	        	ownedElements {
	        		PhysicalProcessingNode NimbusNode {
	        			id NimbusNode
	        			ip "172.31.16.48"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 8 
	        			os Ubuntu
	        		},
	        		
	        		PhysicalProcessingNode SupervisorNode {
	        			id SupervisorNode
	        			ip "172.31.16.52"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 1
	        			os Ubuntu
	        		},
	        		
	        		PhysicalProcessingNode CassandraNode {
	        			id CassandraNode
	        			ip "172.31.16.47"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 1
	        			os Ubuntu
	        		},
	        		
	        		ProcessingNodeCluster StormCluster {
	        			id StormCluster
	        			nodes ( NimbusNode, SupervisorNode )
	        		},
	        		
	        		ProcessingNodeCluster NimbusCluster {
	        			id NimbusCluster
	        			nodes ( NimbusNode )
	        		}, 
	        		
	        		ProcessingNodeCluster SupervisorCluster {
	        			id SupervisorCluster
	        			nodes ( SupervisorNode )
	        		}, 
	        				
	        		ProcessingNodeCluster CassandraCluster {
	        			id CasandraCluster
	        			nodes ( CassandraNode )
	        		},
	        		
	        		KubernetesCluster "KubernetesCluster" {
	        			id "KubernetesCluster"
	        			kubeConfigPath "C:\\temp\\kubernetes\\kubeConfig"
	        		},
	        		
	        		ZookeeperService PollutionZkpr {
	        			id PollutionZkpr
	        			serverId 0
	        			clientPort "2181"
	        			tickTime 2000
	        			leaderServers true
	        			peerPort "2888"
	        			leaderPort "3888"
	        			initLimit 5
	        			syncLimit 3
	        			host ^KubernetesCluster
	        			deploymentConfig NodeDeploymentConf "zkService.sh"  {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
	        				configFolderPath "/home/gestor/apache/Services/zookeeper/config"
	        				dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
	        				logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
	        				scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
	        			}			
	        		},
	        	
	        		KafkaService PollutionKafka {
	        			commId 1
	        			id PollutionKafka
	        			clientPort "9092"
	        			autoCreateTopicEnable false
	        			deleteTopicEnable false
	        			zookeeperConnect PollutionZkpr
	        			zookeeperConnectionTimeout 6000
	        			numPartitions 4
	        			numRecoveryThreadsPerDataDir 1
	        			logFlushInterval 1000
	        			logFlushIntervalMessages 10000
	        			numIOThreads 8
	        			numNetworkThreads 3
	        			socketReceiveBufferBytes 12400
	        			socketRequestMaxBytes 104857600
	        			socketSendBufferBytes 102400
	        			host ^KubernetesCluster
	        			deploymentConfig KubernetesDeploymentConf "gcr.io/google_containers/kubernetes-kafka" {
	        				replicas 3
	        				imagePullPolicy IfNotPresent
	        				imageTag "1.0-10.2.1"
	        				serviceType LOAD_BALANCER
	        			}
	        			advertisedListeners "PLAINTEXT://172.31.16.47:9092"	
	        			listeners "PLAINTEXT://172.31.16.47:9092"
	        		},
	        		
	        		StormService PollutionStorm {
	        						id PollutionStorm
	        			host NimbusCluster
	        			zookeeperConnect PollutionZkpr
	        			deploymentConfig NodeDeploymentConf "storm" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/services/storm/bin"
	        	            configFolderPath "/home/gestor/apache/services/storm/config"
	        	            dataFolderPath "/home/gestor/apache/services/storm/data"
	        	            logFolderPath "/home/gestor/apache/services/storm/logs"
	        	            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
	        			}
	        			nimbus StormNimbus PollutionStormNimbus {
	        				id PollutionStormNimbus
	        				deploymentConfig NodeDeploymentConf "storm" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/storm/bin"
	        		            configFolderPath "/home/gestor/apache/services/storm/config"
	        		            dataFolderPath "/home/gestor/apache/services/storm/data"
	        		            logFolderPath "/home/gestor/apache/services/storm/logs"
	        		            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
	        				}
	        				host NimbusCluster
	        			}
	        			supervisor StormSupervisor PollutioStormSupervisor {
	        				id PollutionStormSupervisor
	        				deploymentConfig NodeDeploymentConf "storm" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/storm/bin"
	        		            configFolderPath "/home/gestor/apache/services/storm/config"
	        		            dataFolderPath "/home/gestor/apache/services/storm/data"
	        		            logFolderPath "/home/gestor/apache/services/storm/logs"		
	        		            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
	        				}
	        				host SupervisorCluster 
	        				supervisorSlotPorts { "6700", "6701", "6702", "6703" }
	        			}
	        			ui StormUI PollutionStormUI {
	        				id PollutionStormUI
	        				uiPort "8080"
	        				deploymentConfig NodeDeploymentConf "storm" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/storm/bin"
	        		            configFolderPath "/home/gestor/apache/services/storm/config"
	        		            dataFolderPath "/home/gestor/apache/services/storm/data"
	        		            logFolderPath "/home/gestor/apache/services/storm/logs"	
	        		            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
	        				}
	        				host NimbusCluster
	        			}
	        		},
	        		
	        		KafkaWorkloadStreamData Pollution {
	        			id Pollution
	        			cleanupPolicy false
	        			retention_ms 0
	        			retention_bytes 0
	        			numPartitions 1
	        			numReplication 1
	        			messageSize 0
	        			holder PollutionKafka
	        			deploymentConfig KubernetesDeploymentConf "gcr.io/google_containers/kubernetes-kafka" {
	        				replicas 1
	        				imagePullPolicy IfNotPresent
	        				imageTag "1.0-10.2.1"
	        				serviceType LOAD_BALANCER
	        			}
	        			
	        		},
	        		
	        		Workflow PollutionProcess {
	        			id PollutionProcess
	        			ownedTasks { 
	        				Task MainTask {	
	        					id MainTask
	        					triggerStreamData Pollution
	        					implementingClassName "es.unican.dintenr.santanderPollution.SantanderPollutionTopology"
	        					}
	        				}
	        			rootTask MainTask
	        			scheduler PollutionStorm
	        			deploymentConfig NodeDeploymentConf "SantanderPollution.jar" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/pollution/workflows/bin"
	        	            configFolderPath "/home/gestor/apache/pollution/workflows/config"
	        	            dataFolderPath "/home/gestor/apache/pollution/workflows/data"
	        	            logFolderPath "/home/gestor/apache/pollution/workflows/logs"	
	        	            scriptFolderPath "/home/gestor/apache/pollution/workflows/scripts"
	        			}	
	        	
	        		},
	        		
	        		CassandraService PollutionCassandra {
	        			id PollutionCassandra
	        			logging root
	        			passwd root
	        			port 9042
	        			autoBootstrap false
	        			numTokens 255
	        			dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
	        			storagePort "7000"
	        			sslStoragePort "7001"
	        			rpcPort "9160"
	        			host CassandraCluster
	        			deploymentConfig NodeDeploymentConf "Conf cassandra" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/services/cassandra/bin"
	        	            configFolderPath "/home/gestor/apache/services/cassandra/config"
	        	            dataFolderPath "/home/gestor/apache/services/cassandra/data"
	        	            logFolderPath "/home/gestor/apache/services/cassandra/logs"
	        	            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
	        			}
	        			dataCenters { 
	        				DataCenter PollutionCluster {
	        					id PollutionCluster
	        					racks { 
	        						Rack PollutionCluster {
	        							id PollutionCluster
	        							nodes CassandraCluster
	        						}
	        					}
	        				}
	        			}
	        			cqlSchemas { 
	        				ArtifactDescriptor { 
	        					fileName "cassandra_schema"
	        					filePath "/home/gestor/apache/apps/pollution/workflows/data"
	        					localPath "/home/gestor/apache/apps/pollution/workflows/data"
	        				}
	        			}
	        			endpointSnitch "SimpleSnitch"
	        			seeds CassandraCluster
	        			seedProviderClass "SimpleProvider"
	        
	        		}
	        		
	        		
	        	}
	        }
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_DEPLOYMENT_CONF)
	}
	
	@Test
	def void testHostIsOfSwarmClusterDeploymentConfShouldBeOfSwarmDeploymentConf() {
	    val model = parseHelper.parse('''
	        ComputationalSystem SantanderPollution {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	        	ownedElements {
	        		PhysicalProcessingNode NimbusNode {
	        			id NimbusNode
	        			ip "172.31.16.48"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 8 
	        			os Ubuntu
	        		},
	        		
	        		PhysicalProcessingNode SupervisorNode {
	        			id SupervisorNode
	        			ip "172.31.16.52"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 1
	        			os Ubuntu
	        		},
	        		
	        		PhysicalProcessingNode CassandraNode {
	        			id CassandraNode
	        			ip "172.31.16.47"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 1
	        			os Ubuntu
	        		},
	        		
	        		ProcessingNodeCluster StormCluster {
	        			id StormCluster
	        			nodes ( NimbusNode, SupervisorNode )
	        		},
	        		
	        		ProcessingNodeCluster NimbusCluster {
	        			id NimbusCluster
	        			nodes ( NimbusNode )
	        		}, 
	        		
	        		ProcessingNodeCluster SupervisorCluster {
	        			id SupervisorCluster
	        			nodes ( SupervisorNode )
	        		}, 
	        				
	        		ProcessingNodeCluster CassandraCluster {
	        			id CasandraCluster
	        			nodes ( CassandraNode )
	        		},
	        		
	        		SwarmCluster "SwarmCluster" {
	        			id "SwarmCluster"
	        			ip "200.0.0.1"
	        			port "1205"
	        			user root
	        		},
	        		
	        		ZookeeperService PollutionZkpr {
	        			id PollutionZkpr
	        			serverId 0
	        			clientPort "2181"
	        			tickTime 2000
	        			leaderServers true
	        			peerPort "2888"
	        			leaderPort "3888"
	        			initLimit 5
	        			syncLimit 3
	        			host ^SwarmCluster
	        			deploymentConfig KubernetesDeploymentConf zookeeper {
	        				replicas 3
	        				imagePullPolicy IfNotPresent
	        				imageTag "3.7"
	        				serviceType LOAD_BALANCER
	        			}			
	        		},
	        	
	        		KafkaService PollutionKafka {
	        			commId 1
	        			id PollutionKafka
	        			clientPort "9092"
	        			autoCreateTopicEnable false
	        			deleteTopicEnable false
	        			zookeeperConnect PollutionZkpr
	        			zookeeperConnectionTimeout 6000
	        			numPartitions 4
	        			numRecoveryThreadsPerDataDir 1
	        			logFlushInterval 1000
	        			logFlushIntervalMessages 10000
	        			numIOThreads 8
	        			numNetworkThreads 3
	        			socketReceiveBufferBytes 12400
	        			socketRequestMaxBytes 104857600
	        			socketSendBufferBytes 102400
	        			host ^KubernetesCluster
	        			deploymentConfig KubernetesDeploymentConf "gcr.io/google_containers/kubernetes-kafka" {
	        				replicas 3
	        				imagePullPolicy IfNotPresent
	        				imageTag "1.0-10.2.1"
	        				serviceType LOAD_BALANCER
	        			}
	        			advertisedListeners "PLAINTEXT://172.31.16.47:9092"	
	        			listeners "PLAINTEXT://172.31.16.47:9092"
	        		},
	        		
	        		StormService PollutionStorm {
	        			id PollutionStorm
	        			host NimbusCluster
	        			zookeeperConnect PollutionZkpr
	        			deploymentConfig NodeDeploymentConf "storm" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/services/storm/bin"
	        	            configFolderPath "/home/gestor/apache/services/storm/config"
	        	            dataFolderPath "/home/gestor/apache/services/storm/data"
	        	            logFolderPath "/home/gestor/apache/services/storm/logs"
	        	            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
	        			}
	        			nimbus StormNimbus PollutionStormNimbus {
	        				id PollutionStormNimbus
	        				deploymentConfig NodeDeploymentConf "storm" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/storm/bin"
	        		            configFolderPath "/home/gestor/apache/services/storm/config"
	        		            dataFolderPath "/home/gestor/apache/services/storm/data"
	        		            logFolderPath "/home/gestor/apache/services/storm/logs"
	        		            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
	        				}
	        				host NimbusCluster
	        			}
	        			supervisor StormSupervisor PollutioStormSupervisor {
	        				id PollutionStormSupervisor
	        				deploymentConfig NodeDeploymentConf "storm" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/storm/bin"
	        		            configFolderPath "/home/gestor/apache/services/storm/config"
	        		            dataFolderPath "/home/gestor/apache/services/storm/data"
	        		            logFolderPath "/home/gestor/apache/services/storm/logs"		
	        		            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
	        				}
	        				host SupervisorCluster 
	        				supervisorSlotPorts { "6700", "6701", "6702", "6703" }
	        			}
	        			ui StormUI PollutionStormUI {
	        				id PollutionStormUI
	        				uiPort "8080"
	        				deploymentConfig NodeDeploymentConf "storm" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/storm/bin"
	        		            configFolderPath "/home/gestor/apache/services/storm/config"
	        		            dataFolderPath "/home/gestor/apache/services/storm/data"
	        		            logFolderPath "/home/gestor/apache/services/storm/logs"	
	        		            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
	        				}
	        				host NimbusCluster
	        			}
	        		},
	        		
	        		KafkaWorkloadStreamData Pollution {
	        			id Pollution
	        			cleanupPolicy false
	        			retention_ms 0
	        			retention_bytes 0
	        			numPartitions 1
	        			numReplication 1
	        			messageSize 0
	        			holder PollutionKafka
	        			deploymentConfig KubernetesDeploymentConf "gcr.io/google_containers/kubernetes-kafka" {
	        				replicas 1
	        				imagePullPolicy IfNotPresent
	        				imageTag "1.0-10.2.1"
	        				serviceType LOAD_BALANCER
	        			}
	        			
	        		},
	        		
	        		Workflow PollutionProcess {
	        			id PollutionProcess
	        			ownedTasks { 
	        				Task MainTask {	
	        					id MainTask
	        					triggerStreamData Pollution
	        					implementingClassName "es.unican.dintenr.santanderPollution.SantanderPollutionTopology"
	        					}
	        				}
	        			rootTask MainTask
	        			scheduler PollutionStorm
	        			deploymentConfig NodeDeploymentConf "SantanderPollution.jar" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/pollution/workflows/bin"
	        	            configFolderPath "/home/gestor/apache/pollution/workflows/config"
	        	            dataFolderPath "/home/gestor/apache/pollution/workflows/data"
	        	            logFolderPath "/home/gestor/apache/pollution/workflows/logs"	
	        	            scriptFolderPath "/home/gestor/apache/pollution/workflows/scripts"
	        			}	
	        	
	        		},
	        		
	        		CassandraService PollutionCassandra {
	        			id PollutionCassandra
	        			logging root
	        			passwd root
	        			port 9042
	        			autoBootstrap false
	        			numTokens 255
	        			dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
	        			storagePort "7000"
	        			sslStoragePort "7001"
	        			rpcPort "9160"
	        			host CassandraCluster
	        			deploymentConfig NodeDeploymentConf "Conf cassandra" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/services/cassandra/bin"
	        	            configFolderPath "/home/gestor/apache/services/cassandra/config"
	        	            dataFolderPath "/home/gestor/apache/services/cassandra/data"
	        	            logFolderPath "/home/gestor/apache/services/cassandra/logs"
	        	            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
	        			}
	        			dataCenters { 
	        				DataCenter PollutionCluster {
	        					id PollutionCluster
	        					racks { 
	        						Rack PollutionCluster {
	        							id PollutionCluster
	        							nodes CassandraCluster
	        						}
	        					}
	        				}
	        			}
	        			cqlSchemas { 
	        				ArtifactDescriptor { 
	        					fileName "cassandra_schema"
	        					filePath "/home/gestor/apache/apps/pollution/workflows/data"
	        					localPath "/home/gestor/apache/apps/pollution/workflows/data"
	        				}
	        			}
	        			endpointSnitch "SimpleSnitch"
	        			seeds CassandraCluster
	        			seedProviderClass "SimpleProvider"
	        
	        		}
	        		
	        		
	        	}
	        }
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_DEPLOYMENT_CONF)
	}
	
	@Test
	def void testHostIsOfNomadClusterDeploymentConfShouldBeOfNomadDeploymentConf() {
	    val model = parseHelper.parse('''
	        ComputationalSystem SantanderPollution {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	        	ownedElements {
	        		PhysicalProcessingNode NimbusNode {
	        			id NimbusNode
	        			ip "172.31.16.48"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 8 
	        			os Ubuntu
	        		},
	        		
	        		PhysicalProcessingNode SupervisorNode {
	        			id SupervisorNode
	        			ip "172.31.16.52"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 1
	        			os Ubuntu
	        		},
	        		
	        		PhysicalProcessingNode CassandraNode {
	        			id CassandraNode
	        			ip "172.31.16.47"
	        			speedFactor 1.0
	        			userName gestor
	        			concurrencyLevel 1
	        			os Ubuntu
	        		},
	        		
	        		ProcessingNodeCluster StormCluster {
	        			id StormCluster
	        			nodes ( NimbusNode, SupervisorNode )
	        		},
	        		
	        		ProcessingNodeCluster NimbusCluster {
	        			id NimbusCluster
	        			nodes ( NimbusNode )
	        		}, 
	        		
	        		ProcessingNodeCluster SupervisorCluster {
	        			id SupervisorCluster
	        			nodes ( SupervisorNode )
	        		}, 
	        				
	        		ProcessingNodeCluster CassandraCluster {
	        			id CasandraCluster
	        			nodes ( CassandraNode )
	        		},
	        		
	        		NomadCluster "NomadCluster" {
	        			id "NomadCluster"
	        			ip "111.111.111.111"
	        			port "8000"			
	        		},
	        		
	        		ZookeeperService PollutionZkpr {
	        			id PollutionZkpr
	        			serverId 0
	        			clientPort "2181"
	        			tickTime 2000
	        			leaderServers true
	        			peerPort "2888"
	        			leaderPort "3888"
	        			initLimit 5
	        			syncLimit 3
	        			host ^NomadCluster
	        			deploymentConfig NomadDeploymentConf "Conf zookeeper" {
	        				image zookeeper
	        				priority 0
	        				region "region1"
	        				dataCenter dataCenter1
	        				replicas 1
	        				driver JAVA
	        			}			
	        		},
	        	
	        		KafkaService PollutionKafka {
	        			commId 1
	        			id PollutionKafka
	        			clientPort "9092"
	        			autoCreateTopicEnable false
	        			deleteTopicEnable false
	        			zookeeperConnect PollutionZkpr
	        			zookeeperConnectionTimeout 6000
	        			numPartitions 4
	        			numRecoveryThreadsPerDataDir 1
	        			logFlushInterval 1000
	        			logFlushIntervalMessages 10000
	        			numIOThreads 8
	        			numNetworkThreads 3
	        			socketReceiveBufferBytes 12400
	        			socketRequestMaxBytes 104857600
	        			socketSendBufferBytes 102400
	        			host ^NomadCluster
	        			deploymentConfig NodeDeploymentConf "node-kafka" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
	        				configFolderPath "/home/gestor/apache/Services/zookeeper/config"
	        				dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
	        				logFolderPath "/home/gestor/apache/Services/zookeeper/logs"                
	        				scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
	        			}
	        			advertisedListeners "PLAINTEXT://172.31.16.47:9092"
	        			listeners "PLAINTEXT://172.31.16.47:9092"	
	        		},
	        		
	        		StormService PollutionStorm {
	        			id PollutionStorm
	        			host NimbusCluster
	        			zookeeperConnect PollutionZkpr
	        			deploymentConfig NodeDeploymentConf "storm" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/services/storm/bin"
	        	            configFolderPath "/home/gestor/apache/services/storm/config"
	        	            dataFolderPath "/home/gestor/apache/services/storm/data"
	        	            logFolderPath "/home/gestor/apache/services/storm/logs"
	        	            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
	        			}
	        			nimbus StormNimbus PollutionStormNimbus {
	        				id PollutionStormNimbus
	        				deploymentConfig NodeDeploymentConf "storm" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/storm/bin"
	        		            configFolderPath "/home/gestor/apache/services/storm/config"
	        		            dataFolderPath "/home/gestor/apache/services/storm/data"
	        		            logFolderPath "/home/gestor/apache/services/storm/logs"
	        		            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
	        				}
	        				host NimbusCluster
	        			}
	        			supervisor StormSupervisor PollutioStormSupervisor {
	        				id PollutionStormSupervisor
	        				deploymentConfig NodeDeploymentConf "storm" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/storm/bin"
	        		            configFolderPath "/home/gestor/apache/services/storm/config"
	        		            dataFolderPath "/home/gestor/apache/services/storm/data"
	        		            logFolderPath "/home/gestor/apache/services/storm/logs"		
	        		            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
	        				}
	        				host SupervisorCluster 
	        				supervisorSlotPorts { "6700", "6701", "6702", "6703" }
	        			}
	        			ui StormUI PollutionStormUI {
	        				id PollutionStormUI
	        				uiPort "8080"
	        				deploymentConfig NodeDeploymentConf "storm" {
	        					isRunning false
	        					artifactLocator "/home/gestor/apache/services/storm/bin"
	        		            configFolderPath "/home/gestor/apache/services/storm/config"
	        		            dataFolderPath "/home/gestor/apache/services/storm/data"
	        		            logFolderPath "/home/gestor/apache/services/storm/logs"	
	        		            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
	        				}
	        				host NimbusCluster
	        			}
	        		},
	        		
	        		KafkaWorkloadStreamData Pollution {
	        			id Pollution
	        			cleanupPolicy false
	        			retention_ms 0
	        			retention_bytes 0
	        			numPartitions 1
	        			numReplication 1
	        			messageSize 0
	        			holder PollutionKafka
	        			deploymentConfig KubernetesDeploymentConf "gcr.io/google_containers/kubernetes-kafka" {
	        				replicas 1
	        				imagePullPolicy IfNotPresent
	        				imageTag "1.0-10.2.1"
	        				serviceType LOAD_BALANCER
	        			}
	        			
	        		},
	        		
	        		Workflow PollutionProcess {
	        			id PollutionProcess
	        			ownedTasks { 
	        				Task MainTask {	
	        					id MainTask
	        					triggerStreamData Pollution
	        					implementingClassName "es.unican.dintenr.santanderPollution.SantanderPollutionTopology"
	        					}
	        				}
	        			rootTask MainTask
	        			scheduler PollutionStorm
	        			deploymentConfig NodeDeploymentConf "SantanderPollution.jar" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/pollution/workflows/bin"
	        	            configFolderPath "/home/gestor/apache/pollution/workflows/config"
	        	            dataFolderPath "/home/gestor/apache/pollution/workflows/data"
	        	            logFolderPath "/home/gestor/apache/pollution/workflows/logs"	
	        	            scriptFolderPath "/home/gestor/apache/pollution/workflows/scripts"
	        			}
	        
	        			
	        		},
	        		
	        		CassandraService PollutionCassandra {
	        			id PollutionCassandra
	        			logging root
	        			passwd root
	        			port 9042
	        			autoBootstrap false
	        			numTokens 255
	        			dataFileDir "/home/gestor/apache/Services/cassandra/data/data"
	        			storagePort "7000"
	        			sslStoragePort "7001"
	        			rpcPort "9160"
	        			host CassandraCluster
	        			deploymentConfig NodeDeploymentConf "cassandra" {
	        				isRunning false
	        				artifactLocator "/home/gestor/apache/services/cassandra/bin"
	        	            configFolderPath "/home/gestor/apache/services/cassandra/config"
	        	            dataFolderPath "/home/gestor/apache/services/cassandra/data"
	        	            logFolderPath "/home/gestor/apache/services/cassandra/logs"	
	        	            scriptFolderPath "/home/gestor/apache/services/cassandra/scripts"
	        			}
	        			dataCenters { 
	        				DataCenter PollutionCluster {
	        					id PollutionCluster
	        					racks { 
	        						Rack PollutionCluster {
	        							id PollutionCluster
	        							nodes CassandraCluster
	        						}
	        					}
	        				}
	        			}
	        			cqlSchemas { 
	        				ArtifactDescriptor { 
	        					fileName "cassandra_schema"
	        					filePath "/home/gestor/apache/apps/pollution/workflows/data"
	        					localPath "/home/gestor/apache/apps/pollution/workflows/data"
	        				}
	        			}
	        			endpointSnitch "SimpleSnitch"
	        			seeds CassandraCluster
	        			seedProviderClass "SimpleProvider"
	        
	        		}
	        		
	        		
	        	}
	        }
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.INVALID_DEPLOYMENT_CONF)
	}
	
		
	// Kafka Flow Stream Data
	
	@Test
	def void testKafkaFlowStreamDataCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							KafkaFlowStreamData streamData {
								id streamData
								numPartitions 2
								numReplication 2
								retention_ms 2222
								retention_bytes 30393
								cleanupPolicy false
								isImplemented false
								isSingleUse false
								messageSize 3333
								predecessor Pollution
								source Pollution
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "dddd"
									}
								}
								holder PollutionKafka
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort '3333'
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "file"
							}
						}
					}
				}	
			}
		''')

		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testKafkaFlowStreamDataMessageSizeLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							KafkaFlowStreamData streamData {
								id kdkdk
								numPartitions 2
								numReplication 2
								retention_ms 2222
								retention_bytes 30393
								cleanupPolicy false
								isImplemented false
								isSingleUse false
								messageSize -1
								predecessor Pollution
								source Pollution
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "dddd"
									}
								}
								holder PollutionKafka
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort '3333'
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "file"
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_FLOW_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaFlowStreamDataNumPartitionsLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							KafkaFlowStreamData streamData {
								id kdkdk
								numPartitions -1
								numReplication 2
								retention_ms 2222
								retention_bytes 30393
								cleanupPolicy false
								isImplemented false
								isSingleUse false
								messageSize 3333
								predecessor Pollution
								source Pollution
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "dddd"
									}
								}
								holder PollutionKafka
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort '3333'
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "file"
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_FLOW_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaFlowStreamDataNumReplicationLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							KafkaFlowStreamData streamData {
								id kdkdk
								numPartitions 2
								numReplication -1
								retention_ms 2222
								retention_bytes 30393
								cleanupPolicy false
								isImplemented false
								isSingleUse false
								messageSize 3333
								predecessor Pollution
								source Pollution
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "dddd"
									}
								}
								holder PollutionKafka
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort '3333'
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "file"
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_FLOW_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaFlowStreamDataRetentionBytesLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							KafkaFlowStreamData streamData {
								id kdkdk
								numPartitions 2
								numReplication 2
								retention_ms 2222
								retention_bytes -1
								cleanupPolicy false
								isImplemented false
								isSingleUse false
								messageSize 3333
								predecessor Pollution
								source Pollution
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "dddd"
									}
								}
								holder PollutionKafka
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort '3333'
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "file"
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_FLOW_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaFlowStreamDataRetentionsMSLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							KafkaFlowStreamData streamData {
								id streamData
								numPartitions 2
								numReplication 2
								retention_ms -1
								retention_bytes 30393
								cleanupPolicy false
								isImplemented false
								isSingleUse false
								messageSize 3333
								predecessor Pollution
								source Pollution
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "dddd"
									}
								}
								holder PollutionKafka
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort '3333'
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile "file"
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_FLOW_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaFlowStreamDataSchemaFileEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					StreamDataRate rate {
						id rate
						target "workflow.streamData"
					},
					
					PrometheusService prometheus {
						id prometheus
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						ownedStreamData {
							KafkaFlowStreamData streamData {
								id kdkdk
								numPartitions 2
								numReplication 2
								retention_ms 2222
								retention_bytes 30393
								cleanupPolicy false
								isImplemented false
								isSingleUse false
								messageSize 3333
								predecessor Pollution
								source Pollution
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								assignedPartition {
									StreamDataPartition {
										host MyNode
										key "dddd"
									}
								}
								holder PollutionKafka
								ownedMeters {
									StreamRateMeter MeterStreamRate {
										id sdd
										monitoringPort '3333'
										monitoringTime 333
										metric rate
										deploymentConfig NodeDeploymentConf "conf" {
											isRunning false
											artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
							                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
							                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
							                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
										}
										monitoringServer prometheus
									}
								}	
								schemaFile ""
							}
						}
					}
				}	
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_FLOW_STREAM_DATA,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	
	// Kafka Service
	
	@Test
	def void testKafkaServiceCorrect() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "3444"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testKafkaServiceClientPortEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort ""
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testKafkaServiceClientPortSmallerThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "1023"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
		
	@Test
	def void testKafkaServiceClientPortGreaterThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "65536"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testKafkaServiceClientPortNotANumber() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "port"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testKafkaServiceCommIdSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId -1
						id PollutionKafka
						clientPort "3444"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaServiceIdEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id ""
						clientPort "3444"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testKafkaServiceLogFlushIntervalMessagesSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages -1
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaServiceLogFlushIntervalSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval -1
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaServiceNumIOThreadsSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads -1
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaServiceNumNetworkThreadsSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads -1
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaServiceNumPartitionsSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions -1
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaServiceNumRecoveryThreadPerDataDirSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir -1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaServiceSocketReceiveBufferBytesSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes -1
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaServiceSocketRequestMaxBytesSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 102400
						socketRequestMaxBytes -1
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaServiceSocketSendBufferBytesSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes -1
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaServiceZookeeperConnectionTimeoutSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode KafkaNode {
						id KafkaNode
						ip "172.31.16.52"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster KafkaCluster {
						id KafkaCluster
						nodes ( KafkaNode )
					},
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout -1
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host KafkaCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					}
				}
			}
		''')		
		    
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}	
	
		
	// Kafka Workload Stream Data
	
	@Test
	def void testKafkaWorkflowStreamDataCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}	
			}
		''')

		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testKafkaWorkloadStreamDataMessageSizeLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize -1
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}	
			}
		''')
	
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_WORKLOAD_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaWorkloadStreamDataNumPartitionsLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions -1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}	
			}
		''')

		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_WORKLOAD_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaWorkloadStreamDataNumReplicationLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication -1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}	
			}
		''')

		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_WORKLOAD_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaWorkloadStreamDataRetentionBytesLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes -1
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}	
			}
		''')

		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_WORKLOAD_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaWorkloadStreamDataRetentionsMSLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms -1
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}	
			}
		''')

		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_WORKLOAD_STREAM_DATA,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testKafkaWorkloadStreamDataSchemaFileEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						schemaFile ""
					}
				}	
			}
		''')

		validationHelper.assertError(model,
	    	PasysPackage.Literals.KAFKA_WORKLOAD_STREAM_DATA,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	
	// Kubernetes Cluster
	
	@Test
	def void testKubernetesClusterCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					}
				}
			}
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testKubernetesClusterApiVersionEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion ""
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_CLUSTER,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testKubernetesClusterIdEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					KubernetesCluster cluster {
						id ""
						kubeConfigPath "/path/file"
						apiVersion "2"
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_CLUSTER,
	    	MyPasysValidator.EMPTY_FIELD)
	}
		
	@Test
	def void testKubernetesClusterKubeConfigPathEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath ""
						apiVersion "2"
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_CLUSTER,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testKubernetesClusterKubeConfigPathNotAPath() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "//invalid path //"
						apiVersion "2"
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_CLUSTER,
	    	MyPasysValidator.INVALID_PATH)
	}
	
	// Kubernetes Deployment Conf
	
	@Test
	def void testKubernetesDeploymentConfCorrect() {
		val model = parseHelper.parse('''
		ComputationalSystem CompleteSystem {
			date "18/18/2024"
			authors "Julio"
			ownedElements {	
				KubernetesCluster cluster {
					id cluster
					kubeConfigPath "/path/file"
					apiVersion "2"
				},
				
				MemSQLService mem {
					id mem
					host cluster
					logging "logging"
					passwd "logging"
					port 2333	
					deploymentConfig KubernetesDeploymentConf kubernetes {
						replicas 3
						args "args"
						command "ls -s"
						constraints DeploymentConstraints {
							labels "labels"
							resources "resources"
						}
						env "ENV"
						externalIP "200.0.0.1"
						imagePullPolicy IfNotPresent
						imageTag "3.7"
						ports { 
							Port {
								published "published"
								target "target"
							}
						}
						restartPolicy "restart"
						serviceType LOAD_BALANCER
						volumes {
							Volume {
								source "source"
								target "target"
								accessMode READONLYMANY
								type BIND
							}
						}
					}	
				}
			}
		}
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')		
	}
	
	@Test
	def void testKubernetesDeploymentArgsEmpty() {
		val model = parseHelper.parse('''
		ComputationalSystem CompleteSystem {
			date "18/18/2024"
			authors "Julio"
			ownedElements {	
				KubernetesCluster cluster {
					id cluster
					kubeConfigPath "/path/file"
					apiVersion "2"
				},
				
				MemSQLService mem {
					id mem
					host cluster
					logging "logging"
					passwd "logging"
					port 2333	
					deploymentConfig KubernetesDeploymentConf kubernetes {
						replicas 3
						args ""
						command "ls -s"
						constraints DeploymentConstraints {
							labels "labels"
							resources "resources"
						}
						env "ENV"
						externalIP "200.0.0.1"
						imagePullPolicy IfNotPresent
						imageTag "3.7"
						ports { 
							Port {
								published "published"
								target "target"
							}
						}
						restartPolicy "restart"
						serviceType LOAD_BALANCER
						volumes {
							Volume {
								source "source"
								target "target"
								accessMode READONLYMANY
								type BIND
							}
						}
					}	
				}
			}
		}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)		
	}
	
	@Test
	def void testKubernetesDeploymentCommandEmpty() {
		val model = parseHelper.parse('''
		ComputationalSystem CompleteSystem {
			date "18/18/2024"
			authors "Julio"
			ownedElements {	
				KubernetesCluster cluster {
					id cluster
					kubeConfigPath "/path/file"
					apiVersion "2"
				},
				
				MemSQLService mem {
					id mem
					host cluster
					logging "logging"
					passwd "logging"
					port 2333	
					deploymentConfig KubernetesDeploymentConf kubernetes {
						replicas 3
						args "args"
						command ""
						constraints DeploymentConstraints {
							labels "labels"
							resources "resources"
						}
						env "ENV"
						externalIP "200.0.0.1"
						imagePullPolicy IfNotPresent
						imageTag "3.7"
						ports { 
							Port {
								published "published"
								target "target"
							}
						}
						restartPolicy "restart"
						serviceType LOAD_BALANCER
						volumes {
							Volume {
								source "source"
								target "target"
								accessMode READONLYMANY
								type BIND
							}
						}
					}	
				}
			}
		}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testKubernetesDeploymentEnvEmpty() {
		val model = parseHelper.parse('''
		ComputationalSystem CompleteSystem {
			date "18/18/2024"
			authors "Julio"
			ownedElements {	
				KubernetesCluster cluster {
					id cluster
					kubeConfigPath "/path/file"
					apiVersion "2"
				},
				
				MemSQLService mem {
					id mem
					host cluster
					logging "logging"
					passwd "logging"
					port 2333	
					deploymentConfig KubernetesDeploymentConf kubernetes {
						replicas 3
						args "args"
						command "ls -l"
						constraints DeploymentConstraints {
							labels "key=value"
							resources "key2=value2"
						}
						env ""
						externalIP "200.0.0.1"
						imagePullPolicy IfNotPresent
						imageTag "3.7"
						ports { 
							Port {
								published "published"
								target "target"
							}
						}
						restartPolicy "restart"
						serviceType LOAD_BALANCER
						volumes {
							Volume {
								source "source"
								target "target"
								accessMode READONLYMANY
								type BIND
							}
						}
					}	
				}
			}
		}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testKubernetesDeploymentEnvInvalidProperties() {
		val model = parseHelper.parse('''
		ComputationalSystem CompleteSystem {
			date "18/18/2024"
			authors "Julio"
			ownedElements {	
				KubernetesCluster cluster {
					id cluster
					kubeConfigPath "/path/file"
					apiVersion "2"
				},
				
				MemSQLService mem {
					id mem
					host cluster
					logging "logging"
					passwd "logging"
					port 2333	
					deploymentConfig KubernetesDeploymentConf kubernetes {
						replicas 3
						args "args"
						command "ls -l"
						constraints DeploymentConstraints {
							labels "labels"
							resources "resources"
						}
						env "key="
						externalIP "200.0.0.1"
						imagePullPolicy IfNotPresent
						imageTag "3.7"
						ports { 
							Port {
								published "published"
								target "target"
							}
						}
						restartPolicy "restart"
						serviceType LOAD_BALANCER
						volumes {
							Volume {
								source "source"
								target "target"
								accessMode READONLYMANY
								type BIND
							}
						}
					}	
				}
			}
		}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_PROPERTIES_PATTERN)
	}
	
	@Test
	def void testKubernetesDeploymentExternalIpEmpty() {
		val model = parseHelper.parse('''
		ComputationalSystem CompleteSystem {
			date "18/18/2024"
			authors "Julio"
			ownedElements {	
				KubernetesCluster cluster {
					id cluster
					kubeConfigPath "/path/file"
					apiVersion "2"
				},
				
				MemSQLService mem {
					id mem
					host cluster
					logging "logging"
					passwd "logging"
					port 2333	
					deploymentConfig KubernetesDeploymentConf kubernetes {
						replicas 3
						args "args"
						command "ls -l"
						constraints DeploymentConstraints {
							labels "labels"
							resources "resources"
						}
						env "ENV"
						externalIP ""
						imagePullPolicy IfNotPresent
						imageTag "3.7"
						ports { 
							Port {
								published "published"
								target "target"
							}
						}
						restartPolicy "restart"
						serviceType LOAD_BALANCER
						volumes {
							Volume {
								source "source"
								target "target"
								accessMode READONLYMANY
								type BIND
							}
						}
					}	
				}
			}
		}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)		
	}
	
	@Test
	def void testKubernetesDeploymentExternalIpLessThanFourOctets() {
		val model = parseHelper.parse('''
		ComputationalSystem CompleteSystem {
			date "18/18/2024"
			authors "Julio"
			ownedElements {	
				KubernetesCluster cluster {
					id cluster
					kubeConfigPath "/path/file"
					apiVersion "2"
				},
				
				MemSQLService mem {
					id mem
					host cluster
					logging "logging"
					passwd "logging"
					port 2333	
					deploymentConfig KubernetesDeploymentConf kubernetes {
						replicas 3
						args "args"
						command "ls -l"
						constraints DeploymentConstraints {
							labels "labels"
							resources "resources"
						}
						env "ENV"
						externalIP "200.0.1"
						imagePullPolicy IfNotPresent
						imageTag "3.7"
						ports { 
							Port {
								published "published"
								target "target"
							}
						}
						restartPolicy "restart"
						serviceType LOAD_BALANCER
						volumes {
							Volume {
								source "source"
								target "target"
								accessMode READONLYMANY
								type BIND
							}
						}
					}	
				}
			}
		}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_IP)		
	}
	
	@Test
	def void testKubernetesDeploymentExternalIpMoreThanFourOctets() {
		val model = parseHelper.parse('''
		ComputationalSystem CompleteSystem {
			date "18/18/2024"
			authors "Julio"
			ownedElements {	
				KubernetesCluster cluster {
					id cluster
					kubeConfigPath "/path/file"
					apiVersion "2"
				},
				
				MemSQLService mem {
					id mem
					host cluster
					logging "logging"
					passwd "logging"
					port 2333	
					deploymentConfig KubernetesDeploymentConf kubernetes {
						replicas 3
						args "args"
						command "ls -l"
						constraints DeploymentConstraints {
							labels "labels"
							resources "resources"
						}
						env "ENV"
						externalIP "200.0.1.3.638.85"
						imagePullPolicy IfNotPresent
						imageTag "3.7"
						ports { 
							Port {
								published "published"
								target "target"
							}
						}
						restartPolicy "restart"
						serviceType LOAD_BALANCER
						volumes {
							Volume {
								source "source"
								target "target"
								accessMode READONLYMANY
								type BIND
							}
						}
					}	
				}
			}
		}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_IP)		
	}
	
	@Test
	def void testKubernetesDeploymentExternalIpOctetGreaterthan255() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas 3
							args "args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "labels"
								resources "resources"
							}
							env "ENV"
							externalIP "200.0.1.256"
							imagePullPolicy IfNotPresent
							imageTag "3.7"
							ports { 
								Port {
									published "published"
									target "target"
								}
							}
							restartPolicy "restart"
							serviceType LOAD_BALANCER
							volumes {
								Volume {
									source "source"
									target "target"
									accessMode READONLYMANY
									type BIND
								}
							}
						}	
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_IP)
	}
	
	@Test
	def void testKubernetesDeploymentImagePullPolicyEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas 3
							args "args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "labels"
								resources "resources"
							}
							env "ENV"
							externalIP "200.0.1.1"
							imagePullPolicy ""
							imageTag "3.7"
							ports { 
								Port {
									published "published"
									target "target"
								}
							}
							restartPolicy "restart"
							serviceType LOAD_BALANCER
							volumes {
								Volume {
									source "source"
									target "target"
									accessMode READONLYMANY
									type BIND
								}
							}
						}	
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	@Test
	def void testKubernetesDeploymentImageTagEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas 3
							args "args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "labels"
								resources "resources"
							}
							env "ENV"
							externalIP "200.0.1.1"
							imagePullPolicy IfNotPresent
							imageTag ""
							ports { 
								Port {
									published "published"
									target "target"
								}
							}
							restartPolicy "restart"
							serviceType LOAD_BALANCER
							volumes {
								Volume {
									source "source"
									target "target"
									accessMode READONLYMANY
									type BIND
								}
							}
						}	
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	@Test
	def void testKubernetesDeploymentReplicasLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas -1
							args "args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "labels"
								resources "resources"
							}
							env "ENV"
							externalIP "200.0.1.1"
							imagePullPolicy IfNotPresent
							imageTag "3.7"
							ports { 
								Port {
									published "published"
									target "target"
								}
							}
							restartPolicy "restart"
							serviceType LOAD_BALANCER
							volumes {
								Volume {
									source "source"
									target "target"
									accessMode READONLYMANY
									type BIND
								}
							}
						}	
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_DEPLOYMENT_CONF,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)	
	}
	
	@Test
	def void testKubernetesDeploymentRestartPolicyEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas 3
							args "args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "labels"
								resources "resources"
							}
							env "ENV"
							externalIP "200.0.1.1"
							imagePullPolicy IfNotPresent
							imageTag "3.7"
							ports { 
								Port {
									published "published"
									target "target"
								}
							}
							restartPolicy ""
							serviceType LOAD_BALANCER
							volumes {
								Volume {
									source "source"
									target "target"
									accessMode READONLYMANY
									type BIND
								}
							}
						}	
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.KUBERNETES_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	// MemSQL Service
	
	@Test
	def void testMemSQLServiceCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode node {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster cluster {
						id cluster
						nodes ( node )
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "logging"
						passwd "logging"
						port 1025	
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}
			}
		''')
	
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
		
	@Test
	def void testMemSQLServiceIdEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode node {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster cluster {
						id cluster
						nodes ( node )
					},
					
					MemSQLService mem {
						id ""
						host cluster
						logging "logging"
						passwd "logging"
						port 1025	
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.MEM_SQL_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testMemSQLServiceLoggingEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode node {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster cluster {
						id cluster
						nodes ( node )
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging ""
						passwd "logging"
						port 1025	
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.MEM_SQL_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testMemSQLServicePasswordEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode node {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster cluster {
						id cluster
						nodes ( node )
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "logging"
						passwd ""
						port 1025	
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.MEM_SQL_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testMemSQLServicePortSmallerThanAllowed() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode node {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster cluster {
						id cluster
						nodes ( node )
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "logging"
						passwd "logging"
						port 1023	
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.MEM_SQL_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testMemSQLServicePortGreaterThanAllowed() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode node {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster cluster {
						id cluster
						nodes ( node )
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "logging"
						passwd "logging"
						port 65536
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.MEM_SQL_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	// Neo4J Service
	
	@Test
	def void testNeo4JServiceCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode node {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster cluster {
						id cluster
						nodes ( node )
					},
					
					Neo4JService neo {
						id neo
						host cluster
						logging "logging"
						passwd "logging"
						port 1025
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}
			}
		''')
	
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
		
	@Test
	def void testNeo4JServiceIdEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode node {
						id ""
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster cluster {
						id cluster
						nodes ( node )
					},
					
					Neo4JService neo {
						id neo
						host cluster
						logging ""
						passwd "logging"
						port 1025
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NEO4_JSERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testNeo4JServiceLoggingEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode node {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster cluster {
						id cluster
						nodes ( node )
					},
					
					Neo4JService neo {
						id neo
						host cluster
						logging ""
						passwd "logging"
						port 1025
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NEO4_JSERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testNeo4JServicePasswordEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode node {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster cluster {
						id cluster
						nodes ( node )
					},
					
					Neo4JService neo {
						id neo
						host cluster
						logging "logging"
						passwd ""
						port 1025
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NEO4_JSERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testNeo4JServicePortSmallerThanAllowed() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode node {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster cluster {
						id cluster
						nodes ( node )
					},
					
					Neo4JService neo {
						id neo
						host cluster
						logging "logging"
						passwd "logging"
						port 1023	
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NEO4_JSERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testNeo4JServicePortGreaterThanAllowed() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode node {
						id CassandraNode
						ip "172.31.16.47"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
					ProcessingNodeCluster cluster {
						id cluster
						nodes ( node )
					},
					
					Neo4JService neo {
						id neo
						host cluster
						logging "logging"
						passwd "logging"
						port 65536	
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NEO4_JSERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
		
	// Network
	
	@Test
	def void testNetworkCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					Network network1 {
						id network1
						bandwith 3.0
					}
				}
			}
		''')	
		
		Assertions.assertNotNull(model)
			val errors = model.eResource.errors
			Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')	
	}
	
	@Test
	def void testNetworkIdEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					Network network {
						id ""
						bandwith 3.0
					}
				}
			}
		''')	
		
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NETWORK,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testNetworkBandwithLessThan0() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					Network network {
						id "network"
						bandwith -0.0001
					}
				}
			}
		''')	
		
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NETWORK,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	
	
	// Node Deployment Conf
	
	@Test
	def void testNodeDeploymentConfCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							arguments { "arg" , "arg2" }		
							artifactLocator "/home/gestor/apache/Services/zookeeper/artf"
			                codeFolderPath "/home/gestor/apache/Services/zookeeper/code" 
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testNodeDeploymentConfArgumentsEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							arguments { "arg" , "" }		
							artifactLocator "/home/gestor/apache/Services/zookeeper/artf"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testNodeDeploymentConfArtifactLocatorEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator ""
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testNodeDeploymentConfArtifactLocatorNotCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "C:::home"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_PATH)
	}
		
	@Test
	def void testNodeDeploymentConfCodeFolderPathEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "" 
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testNodeDeploymentConfCodeFolderPathNotCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "/?/)!=J" 
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_PATH)
	}

	
	@Test
	def void testNodeDeploymentConfConfigFolderPathEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testNodeDeploymentConfConfigFolderPathNotCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "%my/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_PATH)
	}
	
	@Test
	def void testNodeDeploymentConfDataFolderPathEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/data" 
			                dataFolderPath "=)PATH"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_PATH)
	}
	
	@Test
	def void testNodeDeploymentConfDataFolderPathNotCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
							
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "///P///ath"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_PATH)
	}
	
	@Test
	def void testNodeDeploymentConfLogFolderPathEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testNodeDeploymentConfLogFolderPathNotCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
										
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
							
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "€€€€€€" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_PATH)
	}
	
	@Test
	def void testNodeDeploymentConfScriptFolderPathEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/log" 
							scriptFolderPath ""	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testNodeDeploymentConfScriptFolderPathNotCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "Invalid//Path"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_PATH)
	}
	
	@Test
	def void testNodeDeploymentConfPathsWithSameRoute() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					PhysicalProcessingNode ZkNode {
						id ZkNode
						ip "172.31.16.49"
						speedFactor 1.0
						userName gestor
						concurrencyLevel 8 
						os Ubuntu
					},
												
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "2105"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/bin" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_DEPLOYMENT_CONF,
	    	MyPasysValidator.DUPLICATE_PATHS)
	}
	
				
	// Node Resource Meter
	
	@Test
	def void testNodeResourceMeterMonitoringPortIsEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath "/path"
								localPath "/path"
							}
						)
						concurrencyLevel 2
						configData "configData"
						configFiles (
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
						connectedTo ( network )
						launchingScripts ( 
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType KAFKA_FLOW_STREAM
								owner MyNode
							}
						)
						memorySize 255
						os "W"
						ownedMeters { 
							NodeResourceMeter resourceMeter {
								id resourceMeter
								monitoringPort ""
								monitoringTime 323232
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								mMetric nodememory
								monitoringServer prometheus
								uMetric nodeutilization
							}
						}	
					},
					
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					Network network {
						id network
						bandwith 3.0
					},
					
					NetworkUtilization networkUt {
						id net
						target network
					},
					
					ProcessingNodeMemory nodememory {
						id nodememory
						target MyNode
					},
					
					ProcessingNodeUtilization nodeutilization {
						id utilization
						target MyNode 
					},
					
					PrometheusService prometheus {
						id prometheus
						host cluster
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas 1
							args "ddd"
							command "dddd"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "Properties"
							externalIP "200.0.0.1"
							imagePullPolicy "ed"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							serviceType CLUSTER_IP
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}			
						}	
						exportersData { 
							ExporterData data {
								artifact "dd"
							}
						}
						monitorizedMeters ( "MyNode.meter1" )
					}
				 }
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_RESOURCE_METER,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}

	@Test
	def void testNodeResourceMeterMonitoringPortSmallerThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath "/path"
								localPath "/path"
							}
						)
						concurrencyLevel 2
						configData "configData"
						configFiles (
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
						connectedTo ( network )
						launchingScripts ( 
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType KAFKA_FLOW_STREAM
								owner MyNode
							}
						)
						memorySize 255
						os "W"
						ownedMeters { 
							NodeResourceMeter resourceMeter {
								id resourceMeter
								monitoringPort "1023"
								monitoringTime 323232
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								mMetric nodememory
								monitoringServer prometheus
								uMetric nodeutilization
							}
						}	
					},
					
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					Network network {
						id network
						bandwith 3.0
					},
					
					NetworkUtilization networkUt {
						id net
						target network
					},
					
					ProcessingNodeMemory nodememory {
						id nodememory
						target MyNode
					},
					
					ProcessingNodeUtilization nodeutilization {
						id utilization
						target MyNode 
					},
					
					PrometheusService prometheus {
						id prometheus
						host cluster
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas 1
							args "ddd"
							command "dddd"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "Properties"
							externalIP "200.0.0.1"
							imagePullPolicy "ed"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							serviceType CLUSTER_IP
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}			
						}	
						exportersData { 
							ExporterData data {
								artifact "dd"
							}
						}
						monitorizedMeters ( "MyNode.meter1" )
					}
				 }
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_RESOURCE_METER,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testNodeResourceMeterMonitoringPortGreaterThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						codeFiles ( 
							ArtifactDescriptor {
								fileName "file"
								filePath "/path"
								localPath "/path"
							}
						)
						concurrencyLevel 2
						configData "configData"
						configFiles (
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType AVRO_SERVICE
								owner MyNode
							}
						)
						connectedTo ( network )
						launchingScripts ( 
							DeploymentFileDescriptor {
								fileContent "content"
								fileName "file"
								filePath "/path"
								elementType KAFKA_FLOW_STREAM
								owner MyNode
							}
						)
						memorySize 255
						os "W"
						ownedMeters { 
							NodeResourceMeter resourceMeter {
								id resourceMeter
								monitoringPort "65536"
								monitoringTime 323232
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								mMetric nodememory
								monitoringServer prometheus
								uMetric nodeutilization
							}
						}	
					},
					
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					Network network {
						id network
						bandwith 3.0
					},
					
					NetworkUtilization networkUt {
						id net
						target network
					},
					
					ProcessingNodeMemory nodememory {
						id nodememory
						target MyNode
					},
					
					ProcessingNodeUtilization nodeutilization {
						id utilization
						target MyNode 
					},
					
					PrometheusService prometheus {
						id prometheus
						host cluster
						deploymentConfig KubernetesDeploymentConf kubernetes {
							replicas 1
							args "ddd"
							command "dddd"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "Properties"
							externalIP "200.0.0.1"
							imagePullPolicy "ed"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							serviceType CLUSTER_IP
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}			
						}	
						exportersData { 
							ExporterData data {
								artifact "dd"
							}
						}
						monitorizedMeters ( "MyNode.meter1" )
					}
				 }
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_RESOURCE_METER,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}

	
	@Test
	def void testNodeResourceMeterMonitoringTimeLessThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						ownedMeters { 
							NodeResourceMeter resourceMeter {
								id resourceMeter
								monitoringPort "5444"
								monitoringTime -1
								deploymentConfig NodeDeploymentConf "conf" {
									isRunning false
									artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
					                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
					                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
					                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
					                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
								}
								mMetric nodememory
								uMetric nodeutilization
							}
						}	
					},
					
					ProcessingNodeMemory nodememory {
						id nodememory
						target MyNode
					},
							
					ProcessingNodeUtilization nodeutilization {
						id utilization
						target MyNode 
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NODE_RESOURCE_METER,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	
	// Nomad Cluster
	
	@Test
	def void testNomadClusterCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					}
				}
			}
		''')
		
		Assertions.assertNotNull(model)
			val errors = model.eResource.errors
			Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testNomadClusterIdEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					NomadCluster nomad {
						id ""
						ip "200.0.0.2"
						port "5554"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_CLUSTER,
	    	MyPasysValidator.EMPTY_FIELD) 
	}
	
	@Test
	def void testNomadClusterIpEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					NomadCluster nomad {
						id nomad
						ip ""
						port "5554"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_CLUSTER,
	    	MyPasysValidator.EMPTY_FIELD) 
	}
	
	@Test
	def void testNomadClusterIpLessThanFourOctets() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					NomadCluster nomad {
						id nomad
						ip "222.22.2"
						port "5554"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_CLUSTER,
	    	MyPasysValidator.INVALID_IP) 
	}
		
	@Test
	def void testNomadClusterIpMoreThanFourOctets() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2."
						port "5554"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_CLUSTER,
	    	MyPasysValidator.INVALID_IP) 
	}
	
	@Test
	def void testNomadClusterIpNoDotsForSeparation() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					NomadCluster nomad {
						id nomad
						ip "222.22.2 2"
						port "5554"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_CLUSTER,
	    	MyPasysValidator.INVALID_IP) 
	}
	
	@Test
	def void testNomadClusterPortEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port ""
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_CLUSTER,
	    	MyPasysValidator.EMPTY_FIELD) 
	}
	
	@Test
	def void testNomadClusterPortSmallerThanAllowed() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "1023"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_CLUSTER,
	    	MyPasysValidator.INVALID_PORT_VALUE) 
	}
	
	@Test
	def void testNomadClusterPortGreaterThanAllowed() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "65536"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_CLUSTER,
	    	MyPasysValidator.INVALID_PORT_VALUE) 
	}
	
	@Test
	def void testNomadClusterPortNotANumber() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "port"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_CLUSTER,
	    	MyPasysValidator.INVALID_PORT_FORMAT) 
	}
	
	// Nomad Deployment Conf
	
	@Test
	def void testNomadDeploymentConfCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					},
					
					MemSQLService mem {
						id mem
						host nomad
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig NomadDeploymentConf imageTag1 {
							image Ubuntu			
							priority 1
							region "EU-West"
							dataCenter "Berlin"
							replicas 1
							args "ddd"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "Pull"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')		
	}
	
	@Test
	def void testNomadDeploymentArgsEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					},
					
					MemSQLService mem {
						id mem
						host nomad
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig NomadDeploymentConf imageTag1 {
							image Ubuntu			
							priority 1
							region "EU-West"
							dataCenter "Berlin"
							replicas 1
							args ""
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "ed"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)		
	}
	
	@Test
	def void testNomadDeploymentCommandEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					},
					
					MemSQLService mem {
						id mem
						host nomad
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig NomadDeploymentConf imageTag1 {
							image Ubuntu			
							priority 1
							region "EU-West"
							dataCenter "Berlin"
							replicas 1
							args "some args"
							command ""
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "ed"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testNomadDeploymentDataCenterEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					},
					
					MemSQLService mem {
						id mem
						host nomad
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig NomadDeploymentConf imageTag1 {
							image "ubuntu"			
							priority 1
							region "EU-West"
							dataCenter ""
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "ed"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	@Test
	def void testNomadDeploymentEnvEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					},
					
					MemSQLService mem {
						id mem
						host nomad
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig NomadDeploymentConf imageTag1 {
							image Ubuntu			
							priority 1
							region "EU-West"
							dataCenter "Berlin"
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env ""
							imagePullPolicy "ed"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testNomadDeploymentEnvInvalidProperties() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					},
					
					MemSQLService mem {
						id mem
						host nomad
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig NomadDeploymentConf imageTag1 {
							image Ubuntu			
							priority 1
							region "EU-West"
							dataCenter "Berlin"
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key="
							imagePullPolicy "ed"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_PROPERTIES_PATTERN)
	}

	@Test
	def void testNomadDeploymentImagePullPolicyEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					},
					
					MemSQLService mem {
						id mem
						host nomad
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig NomadDeploymentConf imageTag1 {
							image Ubuntu			
							priority 1
							region "EU-West"
							dataCenter "Berlin"
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy ""
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	@Test
	def void testNomadDeploymentImageEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					},
					
					MemSQLService mem {
						id mem
						host nomad
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig NomadDeploymentConf imageTag1 {
							image ""			
							priority 1
							region "EU-West"
							dataCenter "Berlin"
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "ed"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	@Test
	def void testNomadDeploymentPriorityLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					},
					
					MemSQLService mem {
						id mem
						host nomad
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig NomadDeploymentConf imageTag1 {
							image "EU-West"			
							priority -1
							region "EU-West"
							dataCenter "Berlin"
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "ed"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_DEPLOYMENT_CONF,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)	
	}
	
	@Test
	def void testNomadDeploymentRegionEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					},
					
					MemSQLService mem {
						id mem
						host nomad
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig NomadDeploymentConf imageTag1 {
							image "ubuntu"			
							priority 1
							region ""
							dataCenter "Berlin"
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "ed"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	@Test
	def void testNomadDeploymentReplicasLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					},
					
					MemSQLService mem {
						id mem
						host nomad
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig NomadDeploymentConf imageTag1 {
							image Ubuntu			
							priority 1
							region "EU-West"
							dataCenter "Berlin"
							replicas -1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "ed"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_DEPLOYMENT_CONF,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)	
	}
	
	@Test
	def void testNomadDeploymentRestartPolicyEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					NomadCluster nomad {
						id nomad
						ip "222.22.2.2"
						port "5554"
					},
					
					MemSQLService mem {
						id mem
						host nomad
						logging "logging"
						passwd "logging"
						port 2333	
						deploymentConfig NomadDeploymentConf imageTag1 {
							image Ubuntu			
							priority 1
							region "EU-West"
							dataCenter "Berlin"
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "ed"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy ""
							volumes {
								Volume {
									source "dd"
									target "dd"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.NOMAD_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	
	// Port
	
	@Test
	def void testPortCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig KubernetesDeploymentConf "New Kubernetes Deployment Conf" {
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "label"
								resources "resources"
							}
							env "key=value"
							externalIP "200.0.0.1"
							imagePullPolicy "pull"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
						}
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "/home/gestor/apache/Services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					}
				}
			}
		''')
	
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testPortPublishedEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig KubernetesDeploymentConf "New Kubernetes Deployment Conf" {
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "label"
								resources "resources"
							}
							env "key=value"
							externalIP "200.0.0.1"
							imagePullPolicy "pull"
							imageTag "tag"
							ports {
								Port {
									published ""
									target "target"
								}
							}
						}
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "/home/gestor/apache/Services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.PORT,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testPortTargetEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig KubernetesDeploymentConf "New Kubernetes Deployment Conf" {
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "label"
								resources "resources"
							}
							env "key=value"
							externalIP "200.0.0.1"
							imagePullPolicy "pull"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target ""
								}
							}
						}
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "/home/gestor/apache/Services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.PORT,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	
	// Processing Node
	
	@Test
	def void testProcessingNodeCorrect() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                PhysicalProcessingNode InvalidNode {
	                   id MyNode
	                   ip "127.0.0.1"
	                   speedFactor 1.0
	                   userName "Julio"
	                }
	            }
	        }
	    ''')
	    
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testProcessingNodeConcurrencyLevelSmallerThanZero() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                PhysicalProcessingNode InvalidNode {
	                   id MyNode
	                   ip "127.0.0.1"
	                   speedFactor 1.0
	                   userName "Julio"
	                   codeFiles ( 
	                    	ArtifactDescriptor {
	                    		fileName "file"
	                    		filePath "/path"
	                    		localPath "/path"
	                    	}
	                   )
	                   concurrencyLevel -1
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.PROCESSING_NODE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testProcessingNodeConfiDataEmpty() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                PhysicalProcessingNode InvalidNode {
	                   id MyNode
	                   ip "127.0.0.1"
	                   speedFactor 1.0
	                   userName "Julio"
	                   configData ""
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testProcessingNodeConfigDataInvalidPattern() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                PhysicalProcessingNode InvalidNode {
	                   id MyNode
	                   ip "127.0.0.1"
	                   speedFactor 1.0
	                   userName "Julio"
	                   configData "key1=value1, key2="
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.PROCESSING_NODE,
	    	MyPasysValidator.INVALID_PROPERTIES_PATTERN)
	}
	
	@Test
	def void testProcessingNodeIpEmpty() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                PhysicalProcessingNode InvalidNode {
	                    id "InvalidNode"
	                    ip ""
	                    speedFactor 1.0
	                    userName "Jake"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testProcessingNodeIpLessThanFourOctets() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                PhysicalProcessingNode InvalidNode {
	                    id "InvalidNode"
	                    ip "255.255.255"
	                    speedFactor 1.0
	                    name "Jake"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.PROCESSING_NODE,
	    	MyPasysValidator.INVALID_IP)
	}
	
	@Test
	def void testProcessingNodeIpMoreThanFourOctets() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                PhysicalProcessingNode InvalidNode {
	                    id "InvalidNode"
	                    ip "255.255.255.1.100"
	                    speedFactor 1.0
	                    name "Jake"
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.PROCESSING_NODE,
	    	MyPasysValidator.INVALID_IP)
	}
	
	@Test
	def void testProcessingNodeIpNoDotsForSeparation() {
	    val model = parseHelper.parse('''
	        ComputationalSystem System {
	        	date "20/11/2019"
	        	authors "P. López y R. Dintén"
	            ownedElements {
	                PhysicalProcessingNode InvalidNode {
	                    id "InvalidNode"
	                    ip "100 100 100 100"
	                    speedFactor 1.0
	                }
	            }
	        }
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.PROCESSING_NODE,
	    	MyPasysValidator.INVALID_IP)
	}	
	
	@Test
	def void testProcessingNodeMemorySizeSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode InvalidNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						memorySize -1
					}
				}
			}
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.PROCESSING_NODE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
			
	@Test
	def void testProcessingNodeOsEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode InvalidNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
						os ""
					}
				}
			}
	    ''')
	    
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testProcessingNodeSpeedFactorSmallerThanZero() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode Node {
						id Node
						ip "172.31.16.48"
						speedFactor -0.001
						userName gestor
					}
				}
			}
	    ''')
	
	   validationHelper.assertError(model,
	    	PasysPackage.Literals.PROCESSING_NODE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testProcessingNodeSpeedFactorGreaterThanOne() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode NimbusNode {
						id NimbusNode
						ip "172.31.16.48"
						speedFactor 1.001
						userName gestor
					},
				}
			}
	    ''')
	
	   validationHelper.assertError(model,
	    	PasysPackage.Literals.PROCESSING_NODE,
	    	MyPasysValidator.INVALID_SPEED_FACTOR)
	}
	
	@Test
	def void testProcessingNodeUserNameEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode NimbusNode {
						id NimbusNode
						ip "172.31.16.48"
						speedFactor 0.5
						userName ""	
					}
				}
			}
	    ''')
	
	   validationHelper.assertError(model,
	    	PasysPackage.Literals.PROCESSING_NODE,
	    	MyPasysValidator.EMPTY_FIELD)
	}


	// Spark Service

	@Test
	def void testSparkServiceCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores 2
						driverMemory 2333
						driverSuperviser false
						executorMemory 23333
						logCallerContext "context"
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize 23
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize "3333"
						extraListener "listener"
						localDir "correct/path"
						submitDeployMode "deployMode"
						workflows ( MyWorkflow )
					}
				}
			}
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testSparkServiceDriverCoresSmallerThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores -1
						driverMemory 2333
						driverSuperviser false
						executorMemory 23333
						logCallerContext "context"
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize 23
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize "3333"
						extraListener "listener"
						localDir "correct/path"
						submitDeployMode "deployMode"
						workflows ( MyWorkflow )
					}
				}
			}
		''')
	
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SPARK_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testSparkServiceDriverMaxResultSizeEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores 2
						driverMemory 2333
						driverSuperviser false
						executorMemory 23333
						logCallerContext "context"
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize 23
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize ""
						extraListener "listener"
						localDir "correct/path"
						submitDeployMode "deployMode"
						workflows ( MyWorkflow )
					}
				}
			}
		''')
	
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SPARK_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testSparkServiceDriverMaxResultSizeSmallerThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores 2
						driverMemory 2333
						driverSuperviser false
						executorMemory 23333
						logCallerContext "context"
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize 23
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize "-1"
						extraListener "listener"
						localDir "correct/path"
						submitDeployMode "deployMode"
						workflows ( MyWorkflow )
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SPARK_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testSparkServiceDriverMaxResultSizeNotANumber() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores 2
						driverMemory 2333
						driverSuperviser false
						executorMemory 23333
						logCallerContext "context"
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize 23
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize "NotANumber"
						extraListener "listener"
						localDir "correct/path"
						submitDeployMode "deployMode"
						workflows ( MyWorkflow )
					}
				}
			}
		''')
	
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SPARK_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testSparkServiceDriverMemorySmallerThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores 2
						driverMemory -1
						driverSuperviser false
						executorMemory 23333
						logCallerContext "context"
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize 23
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize "3333"
						extraListener "listener"
						localDir "correct/path"
						submitDeployMode "deployMode"
						workflows ( MyWorkflow )
					}
				}
			}
		''')
	
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SPARK_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testSparkServiceExecutorMemoryLessThanZero() {
			val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores 2
						driverMemory 2333
						driverSuperviser false
						executorMemory -1
						logCallerContext "context"
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize 23
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize "3333"
						extraListener "listener"
						localDir "correct/path"
						submitDeployMode "deployMode"
						workflows ( MyWorkflow )
					}
				}
			}
		''')
	
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SPARK_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)	
	}
	
	@Test
	def void testSparkServiceExtraListenerEmpty() {
			val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores 2
						driverMemory 2333
						driverSuperviser false
						executorMemory 23333
						logCallerContext "context"
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize 23
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize "3333"
						extraListener ""
						localDir "correct/path"
						submitDeployMode "deployMode"
						workflows ( MyWorkflow )
					}
				}
			}
		''')
	
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SPARK_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	@Test
	def void testSparkServiceLocalDirEmpty() {
			val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores 2
						driverMemory 2333
						driverSuperviser false
						executorMemory 23333
						logCallerContext "context"
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize 23
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize "3333"
						extraListener "listener"
						localDir ""
						submitDeployMode "deployMode"
						workflows ( MyWorkflow )
					}
				}
			}
		''')
	
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SPARK_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testSparkServiceLocalDirNotAPath() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores 2
						driverMemory 2333
						driverSuperviser false
						executorMemory 23333
						logCallerContext "context"
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize 23
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize "3333"
						extraListener "listener"
						localDir "not>>>correct/path"
						submitDeployMode "deployMode"
						workflows ( MyWorkflow )
					}
				}
			}
		''')
	
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SPARK_SERVICE,
	    	MyPasysValidator.INVALID_PATH)
	}
		
	@Test
	def void testSparkServiceLogCallerContextEmpty() {
			val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores 2
						driverMemory 2333
						driverSuperviser false
						executorMemory 23333
						logCallerContext ""
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize 23
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize "3333"
						extraListener "listener"
						localDir "correct/path"
						submitDeployMode "deployMode"
						workflows ( MyWorkflow )
					}
				}
			}
		''')
	
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SPARK_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)		
	}
	
	@Test
	def void testSparkServiceSubmitDeployModeEmpty() {
			val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores 2
						driverMemory 2333
						driverSuperviser false
						executorMemory 23333
						logCallerContext "context"
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize 23
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize "3333"
						extraListener "listener"
						localDir "correct/path"
						submitDeployMode ""
						workflows ( MyWorkflow )
					}
				}
			}
		''')
	
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SPARK_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)		
	}
	
	@Test
	def void testSparkServiceWindowSizeSmallerThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Jake"
					},
							
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
							codeFolderPath "/home/gestor/apache/services/kafka/code"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "New Deployment Conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
				
					Workflow MyWorkflow {
						id MyWorkflow
						ownedTasks {
							Task MyTask {
								id MyTask
								triggerStreamData Pollution
							}
						}
						rootTask MyTask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
							
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
							codeFolderPath "/home/gestor/apache/services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( MyWorkflow )
					},
					
					SchedulableSet set {
						id set
						workflows ( MyWorkflow )
					},
					
					SparkService sparkSer {
						id sparkSer
						host MyProcessingNodeCluster
						driverCores 2
						driverMemory 2333
						driverSuperviser false
						executorMemory 23333
						logCallerContext "context"
						logConf false
						load set
						master MyProcessingNodeCluster
						windowSize -1
						deploymentConfig NodeDeploymentConf conf {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/sparkSer/bin"
							codeFolderPath "/home/gestor/apache/Services/sparkSer/code"
			                configFolderPath "/home/gestor/apache/Services/sparkSer/config"
			                dataFolderPath "/home/gestor/apache/Services/sparkSer/data"
			                logFolderPath "/home/gestor/apache/Services/sparkSer/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/sparkSer/scripts"
						}		
						driverMaxResultSize "3333"
						extraListener "listener"
						localDir "correct/path"
						submitDeployMode "deployMode"
						workflows ( MyWorkflow )
					}
				}
			}
		''')
	
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SPARK_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)	
	}
	
	// Storm Service
	
	@Test 
	def void testStormServiceCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						
					},
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
						
					StormService PollutionStorm {
						id PollutionStorm
						host MyProcessingNodeCluster
						zookeeperConnect PollutionZkpr
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						nimbus StormNimbus PollutionStormNimbus {
							id PollutionStormNimbus
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
							}
							host MyProcessingNodeCluster
						}
						supervisor StormSupervisor PollutioStormSupervisor {
							id PollutionStormSupervisor
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"		
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
							}
							host MyProcessingNodeCluster 
							supervisorSlotPorts { "6700", "6701", "6702", "6703" }
						}
						localDir "/local/path"
						ui StormUI PollutionStormUI {
							id PollutionStormUI
							uiPort "8080"
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"	
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
							}
							host MyProcessingNodeCluster
						}
						workflows ( workflow )
					}
				}
			}
		''')
	
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testStormServiceLocalDirEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						
					},
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
						
					StormService PollutionStorm {
						id PollutionStorm
						host MyProcessingNodeCluster
						zookeeperConnect PollutionZkpr
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						nimbus StormNimbus PollutionStormNimbus {
							id PollutionStormNimbus
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
							}
							host MyProcessingNodeCluster
						}
						supervisor StormSupervisor PollutioStormSupervisor {
							id PollutionStormSupervisor
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"		
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
							}
							host MyProcessingNodeCluster 
							supervisorSlotPorts { "6700", "6701", "6702", "6703" }
						}
						localDir ""
						ui StormUI PollutionStormUI {
							id PollutionStormUI
							uiPort "8080"
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"	
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
							}
							host MyProcessingNodeCluster
						}
						workflows ( workflow )
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.STORM_SERVICE,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testStormServiceLocalDirNotAPath() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						
					},
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
						
					StormService PollutionStorm {
						id PollutionStorm
						host MyProcessingNodeCluster
						zookeeperConnect PollutionZkpr
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						nimbus StormNimbus PollutionStormNimbus {
							id PollutionStormNimbus
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
							}
							host MyProcessingNodeCluster
						}
						supervisor StormSupervisor PollutioStormSupervisor {
							id PollutionStormSupervisor
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"		
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
							}
							host MyProcessingNodeCluster 
							supervisorSlotPorts { "6700", "6701", "6702", "6703" }
						}
						localDir "$$PathNoValid0"
						ui StormUI PollutionStormUI {
							id PollutionStormUI
							uiPort "8080"
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"	
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
							}
							host MyProcessingNodeCluster
						}
						workflows ( workflow )
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.STORM_SERVICE,
	    	MyPasysValidator.INVALID_PATH)
	}
	
		
	// Storm Supervisor
	
	@Test 
	def void testStormSupervisorSupervisorSlotsEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						
					},
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
						
					StormService PollutionStorm {
						id PollutionStorm
						host MyProcessingNodeCluster
						zookeeperConnect PollutionZkpr
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						nimbus StormNimbus PollutionStormNimbus {
							id PollutionStormNimbus
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
							}
							host MyProcessingNodeCluster
						}
						supervisor StormSupervisor PollutioStormSupervisor {
							id PollutionStormSupervisor
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"		
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
							}
							host MyProcessingNodeCluster 
							supervisorSlotPorts { "", "6701", "6702", "6703" }
						}
						localDir "/local/path"
						ui StormUI PollutionStormUI {
							id PollutionStormUI
							uiPort "8080"
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"	
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
							}
							host MyProcessingNodeCluster
						}
						workflows ( workflow )
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.STORM_SUPERVISOR,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testStormSupervisorSupervisorSlotPortsNotANumber() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						
					},
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
						
					StormService PollutionStorm {
						id PollutionStorm
						host MyProcessingNodeCluster
						zookeeperConnect PollutionZkpr
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						nimbus StormNimbus PollutionStormNimbus {
							id PollutionStormNimbus
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
							}
							host MyProcessingNodeCluster
						}
						supervisor StormSupervisor PollutioStormSupervisor {
							id PollutionStormSupervisor
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"		
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
							}
							host MyProcessingNodeCluster 
							supervisorSlotPorts { "3777", "NotANumber" }
						}
						localDir "/local/path"
						ui StormUI PollutionStormUI {
							id PollutionStormUI
							uiPort "3444"
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"	
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
							}
							host MyProcessingNodeCluster
						}
						workflows ( workflow )
					}
				}
			}
		''')
	   
	   	validationHelper.assertError(model,
    	PasysPackage.Literals.STORM_SUPERVISOR,
    	MyPasysValidator.INVALID_PORT_FORMAT)
    	
	}
	
	@Test
	def void testStormSupervisorSupervisorSlotPortsSmallerThanExpected() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						
					},
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
						
					StormService PollutionStorm {
						id PollutionStorm
						host MyProcessingNodeCluster
						zookeeperConnect PollutionZkpr
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						nimbus StormNimbus PollutionStormNimbus {
							id PollutionStormNimbus
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
							}
							host MyProcessingNodeCluster
						}
						supervisor StormSupervisor PollutioStormSupervisor {
							id PollutionStormSupervisor
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"		
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
							}
							host MyProcessingNodeCluster 
							supervisorSlotPorts { "3444", "2236", "1023" }
						}
						localDir "/local/path"
						ui StormUI PollutionStormUI {
							id PollutionStormUI
							uiPort "3444"
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"	
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
							}
							host MyProcessingNodeCluster
						}
						workflows ( workflow )
					}
				}
			}
		''')
	   
	   	validationHelper.assertError(model,
    	PasysPackage.Literals.STORM_SUPERVISOR,
    	MyPasysValidator.INVALID_PORT_VALUE)
    	
	}
	
	@Test
	def void testStormSupervisorSupervisorSlotPortsGreaterThanExpected() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						
					},
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
						
					StormService PollutionStorm {
						id PollutionStorm
						host MyProcessingNodeCluster
						zookeeperConnect PollutionZkpr
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						nimbus StormNimbus PollutionStormNimbus {
							id PollutionStormNimbus
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
							}
							host MyProcessingNodeCluster
						}
						supervisor StormSupervisor PollutioStormSupervisor {
							id PollutionStormSupervisor
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"		
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
							}
							host MyProcessingNodeCluster 
							supervisorSlotPorts { "65536" }
						}
						localDir "/local/path"
						ui StormUI PollutionStormUI {
							id PollutionStormUI
							uiPort "3444"
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"	
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
							}
							host MyProcessingNodeCluster
						}
						workflows ( workflow )
					}
				}
			}
		''')
	   
	   	validationHelper.assertError(model,
    	PasysPackage.Literals.STORM_SUPERVISOR,
    	MyPasysValidator.INVALID_PORT_VALUE)
    	
	}
	
	
	// Storm UI
	
	@Test 
	def void testStormUIUiPortEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						
					},
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
						
					StormService PollutionStorm {
						id PollutionStorm
						host MyProcessingNodeCluster
						zookeeperConnect PollutionZkpr
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						nimbus StormNimbus PollutionStormNimbus {
							id PollutionStormNimbus
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
							}
							host MyProcessingNodeCluster
						}
						supervisor StormSupervisor PollutioStormSupervisor {
							id PollutionStormSupervisor
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"		
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
							}
							host MyProcessingNodeCluster 
							supervisorSlotPorts { "6700", "6701", "6702", "6703" }
						}
						localDir "/local/path"
						ui StormUI PollutionStormUI {
							id PollutionStormUI
							uiPort ""
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"	
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
							}
							host MyProcessingNodeCluster
						}
						workflows ( workflow )
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.STORM_UI,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test 
	def void testStormUIUiPortSmallerThanAllowed() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						
					},
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
						
					StormService PollutionStorm {
						id PollutionStorm
						host MyProcessingNodeCluster
						zookeeperConnect PollutionZkpr
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						nimbus StormNimbus PollutionStormNimbus {
							id PollutionStormNimbus
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
							}
							host MyProcessingNodeCluster
						}
						supervisor StormSupervisor PollutioStormSupervisor {
							id PollutionStormSupervisor
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"		
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
							}
							host MyProcessingNodeCluster 
							supervisorSlotPorts { "6700", "6701", "6702", "6703" }
						}
						localDir "/local/path"
						ui StormUI PollutionStormUI {
							id PollutionStormUI
							uiPort "1023"
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"	
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
							}
							host MyProcessingNodeCluster
						}
						workflows ( workflow )
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.STORM_UI,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test 
	def void testStormUIUiPortGreaterThanAllowed() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						
					},
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
						
					StormService PollutionStorm {
						id PollutionStorm
						host MyProcessingNodeCluster
						zookeeperConnect PollutionZkpr
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						nimbus StormNimbus PollutionStormNimbus {
							id PollutionStormNimbus
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
							}
							host MyProcessingNodeCluster
						}
						supervisor StormSupervisor PollutioStormSupervisor {
							id PollutionStormSupervisor
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"		
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
							}
							host MyProcessingNodeCluster 
							supervisorSlotPorts { "6700", "6701", "6702", "6703" }
						}
						localDir "/local/path"
						ui StormUI PollutionStormUI {
							id PollutionStormUI
							uiPort "65536"
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"	
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
							}
							host MyProcessingNodeCluster
						}
						workflows ( workflow )
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.STORM_UI,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test 
	def void testStormUIUiPortNotANumber() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
						advertisedListeners "PLAINTEXT://172.31.16.47:9092"
						listeners "PLAINTEXT://172.31.16.47:9092"	
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						
					},
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
						
					StormService PollutionStorm {
						id PollutionStorm
						host MyProcessingNodeCluster
						zookeeperConnect PollutionZkpr
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						nimbus StormNimbus PollutionStormNimbus {
							id PollutionStormNimbus
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"
							}
							host MyProcessingNodeCluster
						}
						supervisor StormSupervisor PollutioStormSupervisor {
							id PollutionStormSupervisor
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"		
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"			
							}
							host MyProcessingNodeCluster 
							supervisorSlotPorts { "6700", "6701", "6702", "6703" }
						}
						localDir "/local/path"
						ui StormUI PollutionStormUI {
							id PollutionStormUI
							uiPort "NotANumber"
							deploymentConfig NodeDeploymentConf "storm" {
								isRunning false
								artifactLocator "/home/gestor/apache/services/storm/bin"
					            configFolderPath "/home/gestor/apache/services/storm/config"
					            dataFolderPath "/home/gestor/apache/services/storm/data"
					            logFolderPath "/home/gestor/apache/services/storm/logs"	
					            scriptFolderPath "/home/gestor/apache/services/storm/scripts"					
							}
							host MyProcessingNodeCluster
						}
						workflows ( workflow )
					}
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.STORM_UI,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	
	
	// Swarn Cluster
	
	@Test
	def void testSwarmClusterCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					SwarmCluster swarm {
						id swarm
						ip "200.3.3.3"
						port "dd"
						user "julio"
					}
				}
			}
		''')
		
		Assertions.assertNotNull(model)
			val errors = model.eResource.errors
			Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testSwarmClusterIpEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					SwarmCluster swarm {
						id swarm
						ip ""
						port "9876"
						user "julio"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_CLUSTER,
	    	MyPasysValidator.EMPTY_FIELD) 
	}
	
	@Test
	def void testSwarmClusterIpLessThanFourOctets() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					SwarmCluster swarm {
						id swarm
						ip "33.200.33"
						port "dd"
						user "julio"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_CLUSTER,
	    	MyPasysValidator.INVALID_IP) 
	}
		
	@Test
	def void testSwarmClusterIpMoreThanFourOctets() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					SwarmCluster swarm {
						id swarm
						ip "33.200.33.44.5"
						port "9876"
						user "julio"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_CLUSTER,
	    	MyPasysValidator.INVALID_IP) 
	}
	
	@Test
	def void testSwarmClusterIpNoDotsForSeparation() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					SwarmCluster swarm {
						id swarm
						ip "33 200.33.44"
						port "3444"
						user "julio"
					}
				}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_CLUSTER,
	    	MyPasysValidator.INVALID_IP) 
	}
	
	@Test
	def void testSwarmClusterPortEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					SwarmCluster swarm {
						id swarm
						ip "33.200.33.44"
						port ""
						user "julio"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_CLUSTER,
	    	MyPasysValidator.INVALID_PORT_FORMAT) 
	}
	
	@Test
	def void testSwarmClusterPortSmallerThanAllowed() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					SwarmCluster swarm {
						id swarm
						ip "33.200.33.44"
						port "1023"
						user "julio"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_CLUSTER,
	    	MyPasysValidator.INVALID_PORT_VALUE) 
	}
	
	@Test
	def void testSwarmClusterPortGreaterThanAllowed() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					SwarmCluster swarm {
						id swarm
						ip "33.200.33.44"
						port "NotANumber"
						user "julio"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_CLUSTER,
	    	MyPasysValidator.INVALID_PORT_VALUE) 
	}
	
	@Test
	def void testSwarmClusterPortNotANumber() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					SwarmCluster swarm {
						id swarm
						ip "33.200.33.44"
						port "NotANumber"
						user "julio"
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_CLUSTER,
	    	MyPasysValidator.INVALID_PORT_FORMAT) 
	}
	
	@Test
	def void testSwarmClusterUserEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem System {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					SwarmCluster swarm {
						id swarm
						ip "33.333.33.44"
						port "3444"
						user ""
					}
				}
			}
		''')

	    validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_CLUSTER,
	    	MyPasysValidator.EMPTY_FIELD) 
	}
	
	
	// Swarm Deployment Conf
	
	@Test
	def void testSwarmDeploymentConfCorrect() {
		val model = parseHelper.parse('''
		ComputationalSystem CompleteSystem {
			date "18/18/2024"
			authors "Julio"
			ownedElements {	
				KubernetesCluster cluster {
					id cluster
					kubeConfigPath "/path/file"
					apiVersion "2"
				},
				
				MemSQLService mem {
					id mem
					host cluster
					logging "root"
					passwd "root"
					port 2333	
					deploymentConfig SwarmDeploymentConf imageTag1 {
						image Ubuntu			
						replicas 1
						args "some args"
						command "ls -l"
						constraints DeploymentConstraints {
							labels "dd"
							resources "dd"
						}
						env "key=value"
						imagePullPolicy "Policy"
						ports {
							Port {
								published "no"
								target "target"
							}
						}
						restartPolicy "dd"
						volumes {
							Volume {
								source "this"
								target "that"
								accessMode READONLYMANY
								type BIND
							}
						}						
					}
				}
			}
		}
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')		
	}
	
	@Test
	def void testSwarmDeploymentArgsEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "root"
						passwd "root"
						port 2333	
						deploymentConfig SwarmDeploymentConf imageTag1 {
							image Ubuntu			
							replicas 1
							args ""
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "Policy"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "this"
									target "that"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)		
	}
	
	@Test
	def void testSwarmDeploymentCommandEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "root"
						passwd "root"
						port 2333	
						deploymentConfig SwarmDeploymentConf imageTag1 {
							image Ubuntu			
							replicas 1
							args "some args"
							command ""
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "Policy"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "this"
									target "that"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)
	}

	@Test
	def void testSwarmDeploymentImagePullPolicyEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "root"
						passwd "root"
						port 2333	
						deploymentConfig SwarmDeploymentConf imageTag1 {
							image Ubuntu			
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy ""
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "this"
									target "that"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
			''')
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	@Test
	def void testSwarmDeploymentImageEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "root"
						passwd "root"
						port 2333	
						deploymentConfig SwarmDeploymentConf imageTag1 {
							image ""			
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "Policy"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "this"
									target "that"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	@Test
	def void testSwarmDeploymentNetworkEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "root"
						passwd "root"
						port 2333	
						deploymentConfig SwarmDeploymentConf imageTag1 {
							image ""			
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "Policy"
							network ""
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "this"
									target "that"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	@Test
	def void testSwarmDeploymentEnvEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "root"
						passwd "root"
						port 2333	
						deploymentConfig SwarmDeploymentConf imageTag1 {
							image ""			
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env ""
							imagePullPolicy "Policy"
							network ""
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "this"
									target "that"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	@Test
	def void testSwarmDeploymentEnvPropertiesInvalid() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
				SwarmCluster cluster {
					id "SwarmCluster"
					ip "200.0.0.1"
					port "1205"
					user root
					},

					MemSQLService mem {
						id mem
						host cluster
						logging "root"
						passwd "root"
						port 2333	
						deploymentConfig SwarmDeploymentConf imageTag1 {
							image "image"			
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value, key"
							imagePullPolicy "Policy"
							network "localhost"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "this"
									target "that"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_DEPLOYMENT_CONF,
	    	MyPasysValidator.INVALID_PROPERTIES_PATTERN)	
	}
	
	@Test
	def void testSwarmDeploymentReplicasLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "root"
						passwd "root"
						port 2333	
						deploymentConfig SwarmDeploymentConf imageTag1 {
							image Ubuntu			
							replicas -1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "Policy"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "dd"
							volumes {
								Volume {
									source "this"
									target "that"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_DEPLOYMENT_CONF,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)	
	}
	
	@Test
	def void testSwarmDeploymentRestartPolicyEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					KubernetesCluster cluster {
						id cluster
						kubeConfigPath "/path/file"
						apiVersion "2"
					},
					
					MemSQLService mem {
						id mem
						host cluster
						logging "root"
						passwd "root"
						port 2333	
						deploymentConfig SwarmDeploymentConf imageTag1 {
							image Ubuntu			
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "dd"
								resources "dd"
							}
							env "key=value"
							imagePullPolicy "Policy"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy ""
							volumes {
								Volume {
									source "this"
									target "that"
									accessMode READONLYMANY
									type BIND
								}
							}						
						}
					}
				}
			}
		''')
		
		validationHelper.assertError(model,
	    	PasysPackage.Literals.SWARM_DEPLOYMENT_CONF,
	    	MyPasysValidator.EMPTY_FIELD)	
	}
	
	
	// Task Processing Amount
	
	@Test
	def void testTaskProcessingAmountCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
								inputStreamData ( Pollution )
								returnedStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					TaskProcessingAmount taskprocessingAMount {
						id taskprocessingamount
						target "workflow.supertask"		
						histogramBuckectNum 2
						expectedMaxTPA 2
						expectedMinTPA 2
						linearBucketDistribution false
					}
				}
			}
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testTaskProcessingAmountExpectedMaxTPALessThanZero() {
		val model = parseHelper.parse('''
						ComputationalSystem SantanderPollution {
							date "20/11/2019"
							authors "P. López y R. Dintén"
							ownedElements {
								PhysicalProcessingNode MyNode {
									id MyNode
									ip "127.0.0.1"
									speedFactor 1.0
									userName "Julio"
								},
								
								ProcessingNodeCluster MyProcessingNodeCluster {
									id MyProcessingNodeCluster
									nodes ( MyNode )
								},
								
								KafkaService PollutionKafka {
									commId 1
									id PollutionKafka
									clientPort "9092"
									autoCreateTopicEnable false
									deleteTopicEnable false
									zookeeperConnect PollutionZkpr
									zookeeperConnectionTimeout 6000
									numPartitions 4
									numRecoveryThreadsPerDataDir 1
									logFlushInterval 1000
									logFlushIntervalMessages 10000
									numIOThreads 8
									numNetworkThreads 3
									socketReceiveBufferBytes 12400
									socketRequestMaxBytes 104857600
									socketSendBufferBytes 102400
									host MyProcessingNodeCluster
									deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
										isRunning false
										artifactLocator "/home/gestor/apache/services/kafka/bin"
						                configFolderPath "/home/gestor/apache/services/kafka/config"
						                dataFolderPath "/home/gestor/apache/services/kafka/data"
						                logFolderPath "/home/gestor/apache/services/kafka/logs"
						                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
									}
								},
								
								ZookeeperService PollutionZkpr {
									id PollutionZkpr
									serverId 0
									clientPort "2181"
									tickTime 2000
									leaderServers true
									peerPort "2888"
									leaderPort "3888"
									initLimit 5
									syncLimit 3
									host MyProcessingNodeCluster
									deploymentConfig NodeDeploymentConf "zkService.sh" {
										isRunning false
										artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
						                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
						                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
						                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
						                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
									}			
								},
								
								KafkaWorkloadStreamData Pollution {
									id Pollution
									cleanupPolicy false
									retention_ms 0
									retention_bytes 0
									numPartitions 1
									numReplication 1
									messageSize 0
									holder PollutionKafka
									deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
										isRunning false
										artifactLocator "/home/gestor/apache/services/kafka/bin"
						                configFolderPath "/home/gestor/apache/services/kafka/config"
						                dataFolderPath "/home/gestor/apache/services/kafka/data"
						                logFolderPath "/home/gestor/apache/services/kafka/logs"
						                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
									}
								},
								
								Workflow workflow {
									id workflow
									ownedTasks {
										Task supertask {
											id task
											triggerStreamData Pollution
										}
									}
									rootTask supertask
									scheduler nodescheduler
									deploymentConfig NodeDeploymentConf "conf" {
										isRunning false
										artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
						                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
						                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
						                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
						                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
									}
								},
								
								NodeScheduler nodescheduler {
									id nodesscheduler
									host MyProcessingNodeCluster
									deploymentConfig NodeDeploymentConf "conf" {
										isRunning false
										artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
						                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
						                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
						                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
						                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
									}
									workflows ( workflow )
								},
								
								TaskProcessingAmount taskprocessingAMount {
									id taskprocessingamount
									target "workflow.supertask"		
									histogramBuckectNum 2
									expectedMaxTPA -1
									expectedMinTPA 2
									linearBucketDistribution false
								}
							}
						}
		''')
		
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.TASK_PROCESSING_AMOUNT,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}

	@Test
	def void testTaskProcessingAmountExpectedMinTPALessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					},
					
					KafkaWorkloadStreamData Pollution {
						id Pollution
						cleanupPolicy false
						retention_ms 0
						retention_bytes 0
						numPartitions 1
						numReplication 1
						messageSize 0
						holder PollutionKafka
						deploymentConfig NodeDeploymentConf "kafka-Service-start.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/services/kafka/bin"
			                configFolderPath "/home/gestor/apache/services/kafka/config"
			                dataFolderPath "/home/gestor/apache/services/kafka/data"
			                logFolderPath "/home/gestor/apache/services/kafka/logs"
			                scriptFolderPath "/home/gestor/apache/services/kafka/scripts"
						}
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					TaskProcessingAmount taskprocessingAMount {
						id taskprocessingamount
						target "workflow.supertask"		
						histogramBuckectNum 2
						expectedMaxTPA 1
						expectedMinTPA -1
						linearBucketDistribution false
					}
				}
			}
		''')

		validationHelper.assertError(model,
	    	PasysPackage.Literals.TASK_PROCESSING_AMOUNT,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testTaskProcessingAmountHistogramBucketNumLessThanZero() {
		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					Workflow workflow {
						id workflow
						ownedTasks {
							Task supertask {
								id task
								triggerStreamData Pollution
								implementingClassName "class"
								inputStreamData ( Pollution )
								returnedStreamData Pollution
							}
						}
						rootTask supertask
						scheduler nodescheduler
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
					},
					
					NodeScheduler nodescheduler {
						id nodesscheduler
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "conf" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}
						workflows ( workflow )
					},
					
					TaskProcessingAmount taskprocessingAMount {
						id taskprocessingamount
						target "workflow.supertask"		
						histogramBuckectNum -1
						expectedMaxTPA 2
						expectedMinTPA 2
						linearBucketDistribution false
					}
				}
			}
		''')

		validationHelper.assertError(model,
	    	PasysPackage.Literals.TASK_PROCESSING_AMOUNT,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	
	// Volume
	
	@Test
	def void testVolumCorrect() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig KubernetesDeploymentConf "New Kubernetes Deployment Conf" {
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "label"
								resources "resources"
							}
							env "key=value"
							externalIP "200.0.0.1"
							imagePullPolicy "pull"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "restart"
							serviceType CLUSTER_IP
							volumes {
								Volume {
									source "source"
									target "target"
									accessMode READONLYMANY
									type BIND
								}
							}
						}
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "/home/gestor/apache/Services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					}
				}
			}
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testVolumSourceEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig KubernetesDeploymentConf "New Kubernetes Deployment Conf" {
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "label"
								resources "resources"
							}
							env "key=value"
							externalIP "200.0.0.1"
							imagePullPolicy "pull"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "restart"
							serviceType CLUSTER_IP
							volumes {
								Volume {
									source ""
									target "target"
									accessMode READONLYMANY
									type BIND
								}
							}
						}
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "/home/gestor/apache/Services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					}
				}
			}
		''')
		
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.VOLUME,
	    	MyPasysValidator.EMPTY_FIELD)
	}
	
	@Test
	def void testVolumTargetEmpty() {
		val model = parseHelper.parse('''
			ComputationalSystem CompleteSystem {
				date "18/18/2024"
				authors "Julio"
				ownedElements {	
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster MyProcessingNodeCluster {
						id MyProcessingNodeCluster
						nodes ( MyNode )
					},
					
					KafkaService PollutionKafka {
						commId 1
						id PollutionKafka
						clientPort "9092"
						autoCreateTopicEnable false
						deleteTopicEnable false
						zookeeperConnect PollutionZkpr
						zookeeperConnectionTimeout 6000
						numPartitions 4
						numRecoveryThreadsPerDataDir 1
						logFlushInterval 1000
						logFlushIntervalMessages 10000
						numIOThreads 8
						numNetworkThreads 3
						socketReceiveBufferBytes 12400
						socketRequestMaxBytes 104857600
						socketSendBufferBytes 102400
						host MyProcessingNodeCluster
						deploymentConfig KubernetesDeploymentConf "New Kubernetes Deployment Conf" {
							replicas 1
							args "some args"
							command "ls -l"
							constraints DeploymentConstraints {
								labels "label"
								resources "resources"
							}
							env "key=value"
							externalIP "200.0.0.1"
							imagePullPolicy "pull"
							imageTag "tag"
							ports {
								Port {
									published "no"
									target "target"
								}
							}
							restartPolicy "restart"
							serviceType CLUSTER_IP
							volumes {
								Volume {
									source "source"
									target ""
									accessMode READONLYMANY
									type BIND
								}
							}
						}
					},
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2181"
						tickTime 2000
						leaderServers true
						peerPort "2888"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host MyProcessingNodeCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                codeFolderPath "/home/gestor/apache/Services/zookeeper/code"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config"
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs"
			                scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"
						}			
					}
				}
			}
		''')
		
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.VOLUME,
	    	MyPasysValidator.EMPTY_FIELD)
	}

	
	// Zookeeper Service
	
	@Test
	def void testZookeeperServiceCorrect() {
 		val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode ZkNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "3444"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
		''')
		
		Assertions.assertNotNull(model)
		val errors = model.eResource.errors
		Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
	}
	
	@Test
	def void testZookeeperServiceClientPortValueEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort ""
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testZookeeperServiceClientPortValueSmallerThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "1023"
						tickTime 2000
						leaderServers true
						peerPort "1045"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
		
	@Test
	def void testZookeeperServiceClientPortValueGreaterThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "65536"
						tickTime 2000
						leaderServers true
						peerPort "1025"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testZookeeperServiceClientPortNotANumber() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "NotANumber"
						tickTime 2000
						leaderServers true
						peerPort "1045"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testZookeeperServiceLeaderPortValueEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "1025"
						tickTime 2000
						leaderServers true
						peerPort "1026"
						leaderPort ""
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testZookeeperServiceLeaderPortValueSmallerThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "5002"
						leaderPort "1023"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}	
		
	@Test
	def void testZookeeperServiceLeaderPortValueGreaterThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "3888"
						leaderPort "65536"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testZookeeperServiceLeaderPortNotANumber() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "1025"
						tickTime 2000
						leaderServers true
						peerPort "3888"
						leaderPort "NotANumber"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testZookeeperServicePeerPortValueEmpty() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "1025"
						tickTime 2000
						leaderServers true
						peerPort ""
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
		''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testZookeeperServicePeerPortValueSmallerThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1023"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
		
	@Test
	def void testZookeeperServicePeerPortValueGreaterThanAllowed() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "65536"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_PORT_VALUE)
	}
	
	@Test
	def void testZookeeperServicePeerPortNotANumber() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "1025"
						tickTime 2000
						leaderServers true
						peerPort "NotANumber"
						leaderPort "3888"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.INVALID_PORT_FORMAT)
	}
	
	@Test
	def void testZookeeperServiceClientPortAndLeaderPortSameValue() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "1023"
						leaderPort "2100"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.SAME_PORTS)
	}
	
	@Test
	def void testZookeeperServicePeerPortAndLeaderPortSameValue() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2145"
						tickTime 2000
						leaderServers true
						peerPort "2100"
						leaderPort "2100"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.SAME_PORTS)
	}
	
	@Test
	def void testZookeeperServicePeerPortAndClientPortSameValue() {
	    val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2100"
						tickTime 2000
						leaderServers true
						peerPort "2100"
						leaderPort "1023"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.SAME_PORTS)
	}
	
	@Test
	def void testZookeeperServiceTickTimeLessThanZero() {
		 val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2120"
						tickTime -1
						leaderServers true
						peerPort "2100"
						leaderPort "1025"
						initLimit 5
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testZookeeperServiceInitLimitLessThanZero() {
		 val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2120"
						tickTime 2000
						leaderServers true
						peerPort "2100"
						leaderPort "1025"
						initLimit -1
						syncLimit 3
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					},
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testZookeeperServiceSyncLimitLessThanZero() {
		 val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId 0
						clientPort "2120"
						tickTime 2000
						leaderServers true
						peerPort "2100"
						leaderPort "1025"
						initLimit 5
						syncLimit -1
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}
	
	@Test
	def void testZookeeperServerIdLessThanZero() {
		 val model = parseHelper.parse('''
			ComputationalSystem SantanderPollution {
				date "20/11/2019"
				authors "P. López y R. Dintén"
				ownedElements {
					PhysicalProcessingNode MyNode {
						id MyNode
						ip "127.0.0.1"
						speedFactor 1.0
						userName "Julio"
					},
					
					ProcessingNodeCluster ZkCluster {
						id ZkCluster
						nodes ( ZkNode )
					}, 
					
					ZookeeperService PollutionZkpr {
						id PollutionZkpr
						serverId -1
						clientPort "2120"
						tickTime 2000
						leaderServers true
						peerPort "2100"
						leaderPort "1025"
						initLimit 5
						syncLimit 2
						host ZkCluster
						deploymentConfig NodeDeploymentConf "zkService.sh" {
							isRunning false
							artifactLocator "/home/gestor/apache/Services/zookeeper/bin"
			                configFolderPath "/home/gestor/apache/Services/zookeeper/config" 
			                dataFolderPath "/home/gestor/apache/Services/zookeeper/data"
			                logFolderPath "/home/gestor/apache/Services/zookeeper/logs" 
							scriptFolderPath "/home/gestor/apache/Services/zookeeper/scripts"	
						}			
					}
				}
			}
	    ''')
	
	    validationHelper.assertError(model,
	    	PasysPackage.Literals.ZOOKEEPER_SERVICE,
	    	MyPasysValidator.NEGATIVE_NUMERIC_VALUE)
	}

}
